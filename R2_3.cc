/*
 * Copyright 2014 Barry Wardell
 *
 * This file is distributed under the University of Illinois/NCSA
 * Open Source License. See LICENSE file for details.
 *
 */

#include <boost/multi_array.hpp>
#include <complex>
#include <math.h>

#include "Coupling.h"
#include "R2.h"

using std::complex;
using std::vector;

vector<complex<double>> R2_3(const double M, const double r0,
                     const vector<double> &r, const vector<double> &f, const vector<double> &fp,
                     const field_type &h, const field_type &dh, const field_type &ddh,
                     int l3, int m3, int l1, int m1, int l2, int m2) {
  vector<complex<double>> ricci(r.size());
  const complex<double> I(0.0, 1.0);
  const double Omega = sqrt(M/(r0*r0*r0));
  const double Omega_2 = Omega*Omega;
  const double l1d = l1, m1d = m1, l2d = l2, m2d = m2;
  const double c1 = Coupling(l3,m3,0,l1,m1,0,l2,m2,0);
  const double c2 = Coupling(l3,m3,0,l1,m1,-1,l2,m2,1);
  const double c3 = Coupling(l3,m3,0,l1,m1,1,l2,m2,-1);
  const double c4 = Coupling(l3,m3,0,l1,m1,2,l2,m2,-2);
  const double c5 = Coupling(l3,m3,0,l1,m1,-2,l2,m2,2);
  const double sqrtl1 = sqrt(l1d*(1.0 + l1d));
  const double sqrtl2 = sqrt(l1d*(1.0 + l1d)*l2d*(1.0 + l2d));
  const double sqrtl3 = sqrt(l1d*(-2. - 1.*l1d + 2.*l1d*l1d + l1d*l1d*l1d));
  const double sqrtl4 = sqrt(-2. + l1d + l1d*l1d);
  const double sqrtl5 = 1.0/sqrtl1;

  if(l1==0&&l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      double f_4 = f_2*f_2;
      ricci[j] = (0.35355339059327373*c1*(2.*f_2*r_4*(-dh[1][0][0][j]*dh[1][0][0][j] + dh[2][0][0][j]*dh[2][0][0][j]) - 8.*h[1][0][0][j]*h[1][0][0][j] + 8.*h[2][0][0][j]*h[2][0][0][j] + 4.*f[j]*r[j]*(r[j]*dh[1][0][0][j]*h[1][0][0][j] - 2.*h[1][0][0][j]*h[1][0][0][j] - r[j]*dh[2][0][0][j]*h[2][0][0][j] + 2.*h[2][0][0][j]*h[2][0][0][j]) - 2.*f_3*r_2*(r_2*dh[1][0][0][j]*dh[3][0][0][j] + r_2*ddh[1][0][0][j]*h[3][0][0][j] + 2.*dh[3][0][0][j]*h[3][0][0][j] + 2.*(-(r[j]*dh[1][0][0][j]) + dh[6][0][0][j])*h[6][0][0][j]) - f_4*r_3*(r[j]*(2.*dh[3][0][0][j]*dh[3][0][0][j] + dh[6][0][0][j]*dh[6][0][0][j] + 2.*ddh[3][0][0][j]*h[3][0][0][j]) + 2.*(r[j]*ddh[6][0][0][j] + 2.*dh[6][0][0][j])*h[6][0][0][j])))/(f_3*r_4);
    }
  } else if(l1==1&&l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*((-0.35355339059327373*I*m1d*Omega*dh[3][0][0][j]*h[2][1][m1][j])/f[j] - (0.7071067811865475*I*m1d*Omega*h[1][0][0][j]*h[2][1][m1][j])/(f_3*r_2) + dh[1][0][0][j]*(-0.35355339059327373*dh[3][1][m1][j] + (0.7071067811865475*h[1][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[2][1][m1][j])/f_2) - 0.7071067811865475*ddh[1][1][m1][j]*h[3][0][0][j] - 0.7071067811865475*f[j]*ddh[3][1][m1][j]*h[3][0][0][j] + dh[3][1][m1][j]*(-0.7071067811865475*f[j]*dh[3][0][0][j] - (1.4142135623730951*h[3][0][0][j])/r_2) + h[1][1][m1][j]*((-2.8284271247461903*(1 + f[j]*r[j])*h[1][0][0][j])/(f_3*r_4) + (0.7071067811865475*I*m1d*Omega*h[2][0][0][j])/(f_3*r_2) + (0.7071067811865475*m1d*m1d*Omega_2*h[3][0][0][j])/f_2) + dh[2][1][m1][j]*((0.7071067811865475*dh[2][0][0][j])/f[j] - (0.7071067811865475*h[2][0][0][j])/(f_2*r_2) - (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/f[j]) + dh[2][0][0][j]*((0.35355339059327373*I*m1d*Omega*h[1][1][m1][j])/f_2 - (0.7071067811865475*h[2][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[3][1][m1][j])/f[j]) - 0.7071067811865475*f[j]*ddh[6][1][m1][j]*h[6][0][0][j] + (-(dh[5][1][m1][j]/r[j]) - (I*m1d*Omega*h[4][1][m1][j])/(f[j]*r[j]) - h[5][1][m1][j]/r_2)*h[6][0][0][j] + h[3][1][m1][j]*((-0.7071067811865475*m1d*m1d*Omega_2*h[3][0][0][j])/f[j] - (1.4142135623730951*h[6][0][0][j])/r_2) + dh[1][1][m1][j]*((-0.7071067811865475*dh[1][0][0][j])/f[j] - 0.35355339059327373*dh[3][0][0][j] + (0.7071067811865475*h[1][0][0][j])/(f_2*r_2) + (1.4142135623730951*h[6][0][0][j])/r[j]) + h[2][1][m1][j]*((2.8284271247461903*(1 + f[j]*r[j])*h[2][0][0][j])/(f_3*r_4) + (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[6][0][0][j])/(f[j]*r[j])) + dh[6][1][m1][j]*(-0.35355339059327373*f[j]*dh[6][0][0][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][0][0][j])/r_2) - (0.7071067811865475*f[j]*dh[6][0][0][j]*h[6][1][m1][j])/r[j] - (0.7071067811865475*m1d*m1d*Omega_2*h[6][0][0][j]*h[6][1][m1][j])/f[j]);    
    }
  } else if(l1==0&&l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*(dh[1][1][m2][j]*(-0.35355339059327373*dh[3][0][0][j] + (0.7071067811865475*h[1][0][0][j])/(f_2*r_2)) - (0.7071067811865475*dh[2][1][m2][j]*h[2][0][0][j])/(f_2*r_2) + (0.7071067811865475*I*m2d*Omega*h[1][1][m2][j]*h[2][0][0][j])/(f_3*r_2) + (2.8284271247461903*(1 + f[j]*r[j])*h[2][0][0][j]*h[2][1][m2][j])/(f_3*r_4) + h[1][0][0][j]*((-2.8284271247461903*(1 + f[j]*r[j])*h[1][1][m2][j])/(f_3*r_4) - (0.7071067811865475*I*m2d*Omega*h[2][1][m2][j])/(f_3*r_2)) - 0.7071067811865475*ddh[1][0][0][j]*h[3][1][m2][j] - 0.7071067811865475*f[j]*ddh[3][0][0][j]*h[3][1][m2][j] + dh[3][0][0][j]*(-0.7071067811865475*f[j]*dh[3][1][m2][j] - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f[j] - (1.4142135623730951*h[3][1][m2][j])/r_2) + dh[2][0][0][j]*((0.7071067811865475*dh[2][1][m2][j])/f[j] + (0.35355339059327373*I*m2d*Omega*h[1][1][m2][j])/f_2 - (0.7071067811865475*h[2][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[3][1][m2][j])/f[j]) - (0.7071067811865475*f[j]*dh[6][1][m2][j]*h[6][0][0][j])/r[j] - 0.7071067811865475*f[j]*ddh[6][0][0][j]*h[6][1][m2][j] + dh[1][0][0][j]*((-0.7071067811865475*dh[1][1][m2][j])/f[j] - 0.35355339059327373*dh[3][1][m2][j] + (0.7071067811865475*h[1][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f_2 + (1.4142135623730951*h[6][1][m2][j])/r[j]) + dh[6][0][0][j]*(-0.35355339059327373*f[j]*dh[6][1][m2][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][1][m2][j])/r_2));
    }
  } else if(l1==1&&l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*((-0.35355339059327373*I*m1d*Omega*dh[3][1][m2][j]*h[2][1][m1][j])/f[j] + dh[1][1][m2][j]*(-0.35355339059327373*dh[3][1][m1][j] + (0.7071067811865475*h[1][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[2][1][m1][j])/f_2) + h[1][1][m2][j]*((-0.7071067811865475*I*(m1d - m2d)*Omega*h[2][1][m1][j])/(f_3*r_2) + (0.35355339059327373*m1d*m2d*Omega_2*h[3][1][m1][j])/f_2) + dh[2][1][m2][j]*((0.35355339059327373*I*m1d*Omega*h[1][1][m1][j])/f_2 - (0.7071067811865475*h[2][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[3][1][m1][j])/f[j]) - 0.7071067811865475*ddh[1][1][m1][j]*h[3][1][m2][j] - 0.7071067811865475*f[j]*ddh[3][1][m1][j]*h[3][1][m2][j] + dh[3][1][m1][j]*(-0.7071067811865475*f[j]*dh[3][1][m2][j] - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f[j] - (1.4142135623730951*h[3][1][m2][j])/r_2) + h[1][1][m1][j]*((-0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[1][1][m2][j])/(f_3*r_4) + (0.7071067811865475*I*(m1d - m2d)*Omega*h[2][1][m2][j])/(f_3*r_2) + (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[3][1][m2][j])/f_2) + dh[2][1][m1][j]*((0.7071067811865475*dh[2][1][m2][j])/f[j] + (0.35355339059327373*I*m2d*Omega*h[1][1][m2][j])/f_2 - (0.7071067811865475*h[2][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(4.*m1d + m2d)*Omega*h[3][1][m2][j])/f[j]) - (0.7071067811865475*f[j]*dh[6][1][m2][j]*h[6][1][m1][j])/r[j] - 0.7071067811865475*f[j]*ddh[6][1][m1][j]*h[6][1][m2][j] - (dh[5][1][m1][j]*h[6][1][m2][j])/r[j] - (I*m1d*Omega*h[4][1][m1][j]*h[6][1][m2][j])/(f[j]*r[j]) - (h[5][1][m1][j]*h[6][1][m2][j])/r_2 - (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[6][1][m1][j]*h[6][1][m2][j])/f[j] + h[3][1][m1][j]*((-0.7071067811865475*m1d*(m1d + m2d)*Omega_2*h[3][1][m2][j])/f[j] - (1.4142135623730951*h[6][1][m2][j])/r_2) + dh[1][1][m1][j]*((-0.7071067811865475*dh[1][1][m2][j])/f[j] - 0.35355339059327373*dh[3][1][m2][j] + (0.7071067811865475*h[1][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f_2 + (1.4142135623730951*h[6][1][m2][j])/r[j]) + h[2][1][m1][j]*((0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[2][1][m2][j])/(f_3*r_4) + (1.4142135623730951*I*m1d*Omega*h[3][1][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[6][1][m2][j])/(f[j]*r[j])) + dh[6][1][m1][j]*(-0.35355339059327373*f[j]*dh[6][1][m2][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][1][m2][j])/r_2) + (0.7071067811865475*h[8][1][m1][j]*h[8][1][m2][j])/(r_2*f[j]) - (0.7071067811865475*h[9][1][m1][j]*h[9][1][m2][j])/(r_2*f[j])) + c3*(dh[8][1][m2][j]*((0.5*I*h[2][1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + dh[4][1][m2][j]*(0.35355339059327373*I*dh[8][1][m1][j] + h[2][1][m1][j]/(2.*f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + ddh[4][1][m1][j]*(-0.35355339059327373*h[4][1][m2][j] - 0.35355339059327373*I*h[8][1][m2][j]) - 0.35355339059327373*ddh[8][1][m1][j]*h[8][1][m2][j] + dh[2][1][m1][j]*(h[4][1][m2][j]/(2.*f[j]*r[j]) + (0.5*I*h[8][1][m2][j])/(f[j]*r[j])) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j]*h[9][1][m1][j])/(f_2*r_2) + h[5][1][m2][j]*((0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j])/(f_2*r_4)) + dh[5][1][m2][j]*(-0.35355339059327373*I*dh[9][1][m1][j] - h[1][1][m1][j]/(2.*f[j]*r[j]) + h[3][1][m1][j]/(2.*r[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + dh[9][1][m2][j]*((-0.5*I*h[1][1][m1][j])/(f[j]*r[j]) + (0.5*I*h[3][1][m1][j])/r[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + h[4][1][m2][j]*(0.35355339059327373*I*ddh[8][1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m1][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][1][m1][j])/(f_2*r_2)) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j]*h[9][1][m2][j])/(f_2*r_4) + h[3][1][m1][j]*((0.7071067811865475*h[3][1][m2][j])/r_2 - (0.5*I*(m1d - m2d)*Omega*h[4][1][m2][j])/(f[j]*r[j]) + (3.0*h[5][1][m2][j])/(2.*r_2) + ((m1d - m2d)*Omega*h[8][1][m2][j])/(2.*f[j]*r[j]) + (1.5*I*h[9][1][m2][j])/r_2) + h[5][1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][1][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j])/(f_2*r_4)) + dh[8][1][m1][j]*(-0.35355339059327373*dh[8][1][m2][j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[4][1][m1][j]*(-0.35355339059327373*dh[4][1][m2][j] - 0.35355339059327373*I*dh[8][1][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[3][1][m1][j]*(-h[5][1][m2][j]/(2.*r[j]) - (0.5*I*h[9][1][m2][j])/r[j]) + h[2][1][m1][j]*((-0.7071067811865475*h[2][1][m2][j])/(f_2*r_2) + ((-2. + f[j]*r[j])*h[4][1][m2][j])/(2.*f_2*r_3) - (0.5*I*(m1d + m2d)*Omega*h[5][1][m2][j])/(f_2*r[j]) + (0.5*I*(-2. + f[j]*r[j])*h[8][1][m2][j])/(f_2*r_3) + ((m1d + m2d)*Omega*h[9][1][m2][j])/(2.*f_2*r[j])) + dh[1][1][m1][j]*(-h[5][1][m2][j]/(2.*f[j]*r[j]) - (0.5*I*h[9][1][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((0.7071067811865475*h[1][1][m2][j])/(f_2*r_2) + (0.5*I*(m1d + m2d)*Omega*h[4][1][m2][j])/(f_2*r[j]) + ((2. - f[j]*r[j])*h[5][1][m2][j])/(2.*f_2*r_3) - ((m1d + m2d)*Omega*h[8][1][m2][j])/(2.*f_2*r[j]) - (0.5*I*(-2. + f[j]*r[j])*h[9][1][m2][j])/(f_2*r_3)) + dh[5][1][m1][j]*(0.35355339059327373*dh[5][1][m2][j] + 0.35355339059327373*I*dh[9][1][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + dh[9][1][m1][j]*(0.35355339059327373*dh[9][1][m2][j] - (0.35355339059327373*m1d*Omega*h[4][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + h[4][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + h[8][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2))) + c2*(dh[8][1][m2][j]*((-0.5*I*h[2][1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + dh[4][1][m2][j]*(-0.35355339059327373*I*dh[8][1][m1][j] + h[2][1][m1][j]/(2.*f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + ddh[4][1][m1][j]*(-0.35355339059327373*h[4][1][m2][j] + 0.35355339059327373*I*h[8][1][m2][j]) - 0.35355339059327373*ddh[8][1][m1][j]*h[8][1][m2][j] + dh[2][1][m1][j]*(h[4][1][m2][j]/(2.*f[j]*r[j]) - (0.5*I*h[8][1][m2][j])/(f[j]*r[j])) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j]*h[9][1][m1][j])/(f_2*r_2) + h[5][1][m2][j]*((-0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j])/(f_2*r_4)) + dh[5][1][m2][j]*(0.35355339059327373*I*dh[9][1][m1][j] - h[1][1][m1][j]/(2.*f[j]*r[j]) + h[3][1][m1][j]/(2.*r[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + dh[9][1][m2][j]*((0.5*I*h[1][1][m1][j])/(f[j]*r[j]) - (0.5*I*h[3][1][m1][j])/r[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + h[4][1][m2][j]*(-0.35355339059327373*I*ddh[8][1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m1][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][1][m1][j])/(f_2*r_2)) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j]*h[9][1][m2][j])/(f_2*r_4) + h[3][1][m1][j]*((0.7071067811865475*h[3][1][m2][j])/r_2 - (0.5*I*(m1d - m2d)*Omega*h[4][1][m2][j])/(f[j]*r[j]) + (3.0*h[5][1][m2][j])/(2.*r_2) + ((-m1d + m2d)*Omega*h[8][1][m2][j])/(2.*f[j]*r[j]) - (1.5*I*h[9][1][m2][j])/r_2) + h[5][1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][1][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j])/(f_2*r_4)) + dh[4][1][m1][j]*(-0.35355339059327373*dh[4][1][m2][j] + 0.35355339059327373*I*dh[8][1][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[8][1][m1][j]*(-0.35355339059327373*dh[8][1][m2][j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[3][1][m1][j]*(-h[5][1][m2][j]/(2.*r[j]) + (0.5*I*h[9][1][m2][j])/r[j]) + h[2][1][m1][j]*((-0.7071067811865475*h[2][1][m2][j])/(f_2*r_2) + ((-2. + f[j]*r[j])*h[4][1][m2][j])/(2.*f_2*r_3) - (0.5*I*(m1d + m2d)*Omega*h[5][1][m2][j])/(f_2*r[j]) - (0.5*I*(-2. + f[j]*r[j])*h[8][1][m2][j])/(f_2*r_3) - ((m1d + m2d)*Omega*h[9][1][m2][j])/(2.*f_2*r[j])) + dh[1][1][m1][j]*(-h[5][1][m2][j]/(2.*f[j]*r[j]) + (0.5*I*h[9][1][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((0.7071067811865475*h[1][1][m2][j])/(f_2*r_2) + (0.5*I*(m1d + m2d)*Omega*h[4][1][m2][j])/(f_2*r[j]) + ((2. - f[j]*r[j])*h[5][1][m2][j])/(2.*f_2*r_3) + ((m1d + m2d)*Omega*h[8][1][m2][j])/(2.*f_2*r[j]) + (0.5*I*(-2. + f[j]*r[j])*h[9][1][m2][j])/(f_2*r_3)) + dh[5][1][m1][j]*(0.35355339059327373*dh[5][1][m2][j] - 0.35355339059327373*I*dh[9][1][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[8][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + dh[9][1][m1][j]*(0.35355339059327373*dh[9][1][m2][j] + (0.35355339059327373*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + h[8][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + h[4][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][1][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)));
    }
  } else if(l1==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*(dh[1][l2][m2][j]*(-0.35355339059327373*dh[3][0][0][j] + (0.7071067811865475*h[1][0][0][j])/(f_2*r_2)) - (0.7071067811865475*dh[2][l2][m2][j]*h[2][0][0][j])/(f_2*r_2) + (0.7071067811865475*I*m2d*Omega*h[1][l2][m2][j]*h[2][0][0][j])/(f_3*r_2) + (2.8284271247461903*(1 + f[j]*r[j])*h[2][0][0][j]*h[2][l2][m2][j])/(f_3*r_4) + h[1][0][0][j]*((-2.8284271247461903*(1 + f[j]*r[j])*h[1][l2][m2][j])/(f_3*r_4) - (0.7071067811865475*I*m2d*Omega*h[2][l2][m2][j])/(f_3*r_2)) - 0.7071067811865475*ddh[1][0][0][j]*h[3][l2][m2][j] - 0.7071067811865475*f[j]*ddh[3][0][0][j]*h[3][l2][m2][j] + dh[3][0][0][j]*(-0.7071067811865475*f[j]*dh[3][l2][m2][j] - (0.35355339059327373*I*m2d*Omega*h[2][l2][m2][j])/f[j] - (1.4142135623730951*h[3][l2][m2][j])/r_2) + dh[2][0][0][j]*((0.7071067811865475*dh[2][l2][m2][j])/f[j] + (0.35355339059327373*I*m2d*Omega*h[1][l2][m2][j])/f_2 - (0.7071067811865475*h[2][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[3][l2][m2][j])/f[j]) - (0.7071067811865475*f[j]*dh[6][l2][m2][j]*h[6][0][0][j])/r[j] - 0.7071067811865475*f[j]*ddh[6][0][0][j]*h[6][l2][m2][j] + dh[1][0][0][j]*((-0.7071067811865475*dh[1][l2][m2][j])/f[j] - 0.35355339059327373*dh[3][l2][m2][j] + (0.7071067811865475*h[1][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[2][l2][m2][j])/f_2 + (1.4142135623730951*h[6][l2][m2][j])/r[j]) + dh[6][0][0][j]*(-0.35355339059327373*f[j]*dh[6][l2][m2][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][l2][m2][j])/r_2));
    }
  } else if(l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*((-0.35355339059327373*I*m1d*Omega*dh[3][0][0][j]*h[2][l1][m1][j])/f[j] - (0.7071067811865475*I*m1d*Omega*h[1][0][0][j]*h[2][l1][m1][j])/(f_3*r_2) + dh[1][0][0][j]*(-0.35355339059327373*dh[3][l1][m1][j] + (0.7071067811865475*h[1][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[2][l1][m1][j])/f_2) - 0.7071067811865475*ddh[1][l1][m1][j]*h[3][0][0][j] - 0.7071067811865475*f[j]*ddh[3][l1][m1][j]*h[3][0][0][j] + dh[3][l1][m1][j]*(-0.7071067811865475*f[j]*dh[3][0][0][j] - (1.4142135623730951*h[3][0][0][j])/r_2) + h[1][l1][m1][j]*((-2.8284271247461903*(1 + f[j]*r[j])*h[1][0][0][j])/(f_3*r_4) + (0.7071067811865475*I*m1d*Omega*h[2][0][0][j])/(f_3*r_2) + (0.7071067811865475*m1d*m1d*Omega_2*h[3][0][0][j])/f_2) + dh[2][l1][m1][j]*((0.7071067811865475*dh[2][0][0][j])/f[j] - (0.7071067811865475*h[2][0][0][j])/(f_2*r_2) - (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/f[j]) + dh[2][0][0][j]*((0.35355339059327373*I*m1d*Omega*h[1][l1][m1][j])/f_2 - (0.7071067811865475*h[2][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[3][l1][m1][j])/f[j]) - 0.7071067811865475*f[j]*ddh[6][l1][m1][j]*h[6][0][0][j] + ((-0.7071067811865475*sqrtl1*dh[5][l1][m1][j])/r[j] - (0.7071067811865475*I*m1d*sqrtl1*Omega*h[4][l1][m1][j])/(f[j]*r[j]) - (0.7071067811865475*sqrtl1*h[5][l1][m1][j])/r_2)*h[6][0][0][j] + h[3][l1][m1][j]*((-0.7071067811865475*m1d*m1d*Omega_2*h[3][0][0][j])/f[j] - (0.7071067811865475*l1*(1 + l1)*h[6][0][0][j])/r_2) + dh[1][l1][m1][j]*((-0.7071067811865475*dh[1][0][0][j])/f[j] - 0.35355339059327373*dh[3][0][0][j] + (0.7071067811865475*h[1][0][0][j])/(f_2*r_2) + (1.4142135623730951*h[6][0][0][j])/r[j]) + h[2][l1][m1][j]*((2.8284271247461903*(1 + f[j]*r[j])*h[2][0][0][j])/(f_3*r_4) + (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[6][0][0][j])/(f[j]*r[j])) + dh[6][l1][m1][j]*(-0.35355339059327373*f[j]*dh[6][0][0][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][0][0][j])/r_2) - (0.7071067811865475*f[j]*dh[6][0][0][j]*h[6][l1][m1][j])/r[j] - (0.7071067811865475*m1d*m1d*Omega_2*h[6][0][0][j]*h[6][l1][m1][j])/f[j]);
    }
  } else if(l1==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*((-0.35355339059327373*I*m1d*Omega*dh[3][l2][m2][j]*h[2][1][m1][j])/f[j] + dh[1][l2][m2][j]*(-0.35355339059327373*dh[3][1][m1][j] + (0.7071067811865475*h[1][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[2][1][m1][j])/f_2) + h[1][l2][m2][j]*((-0.7071067811865475*I*(m1d - m2d)*Omega*h[2][1][m1][j])/(f_3*r_2) + (0.35355339059327373*m1d*m2d*Omega_2*h[3][1][m1][j])/f_2) + dh[2][l2][m2][j]*((0.35355339059327373*I*m1d*Omega*h[1][1][m1][j])/f_2 - (0.7071067811865475*h[2][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[3][1][m1][j])/f[j]) - 0.7071067811865475*ddh[1][1][m1][j]*h[3][l2][m2][j] - 0.7071067811865475*f[j]*ddh[3][1][m1][j]*h[3][l2][m2][j] + dh[3][1][m1][j]*(-0.7071067811865475*f[j]*dh[3][l2][m2][j] - (0.35355339059327373*I*m2d*Omega*h[2][l2][m2][j])/f[j] - (1.4142135623730951*h[3][l2][m2][j])/r_2) + h[1][1][m1][j]*((-0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[1][l2][m2][j])/(f_3*r_4) + (0.7071067811865475*I*(m1d - m2d)*Omega*h[2][l2][m2][j])/(f_3*r_2) + (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[3][l2][m2][j])/f_2) + dh[2][1][m1][j]*((0.7071067811865475*dh[2][l2][m2][j])/f[j] + (0.35355339059327373*I*m2d*Omega*h[1][l2][m2][j])/f_2 - (0.7071067811865475*h[2][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(4.*m1d + m2d)*Omega*h[3][l2][m2][j])/f[j]) - (0.7071067811865475*f[j]*dh[6][l2][m2][j]*h[6][1][m1][j])/r[j] - 0.7071067811865475*f[j]*ddh[6][1][m1][j]*h[6][l2][m2][j] - (dh[5][1][m1][j]*h[6][l2][m2][j])/r[j] - (I*m1d*Omega*h[4][1][m1][j]*h[6][l2][m2][j])/(f[j]*r[j]) - (h[5][1][m1][j]*h[6][l2][m2][j])/r_2 - (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[6][1][m1][j]*h[6][l2][m2][j])/f[j] + h[3][1][m1][j]*((-0.7071067811865475*m1d*(m1d + m2d)*Omega_2*h[3][l2][m2][j])/f[j] - (1.4142135623730951*h[6][l2][m2][j])/r_2) + dh[1][1][m1][j]*((-0.7071067811865475*dh[1][l2][m2][j])/f[j] - 0.35355339059327373*dh[3][l2][m2][j] + (0.7071067811865475*h[1][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[2][l2][m2][j])/f_2 + (1.4142135623730951*h[6][l2][m2][j])/r[j]) + h[2][1][m1][j]*((0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[2][l2][m2][j])/(f_3*r_4) + (1.4142135623730951*I*m1d*Omega*h[3][l2][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[6][l2][m2][j])/(f[j]*r[j])) + dh[6][1][m1][j]*(-0.35355339059327373*f[j]*dh[6][l2][m2][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][l2][m2][j])/r_2) + (sqrtl2*h[8][1][m1][j]*h[8][l2][m2][j])/(2.*r_2*sqrtl1*f[j]) - (sqrtl2*h[9][1][m1][j]*h[9][l2][m2][j])/(2.*r_2*sqrtl1*f[j])) + c3*(dh[8][l2][m2][j]*((0.5*I*h[2][1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + dh[4][l2][m2][j]*(0.35355339059327373*I*dh[8][1][m1][j] + h[2][1][m1][j]/(2.*f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + ddh[4][1][m1][j]*(-0.35355339059327373*h[4][l2][m2][j] - 0.35355339059327373*I*h[8][l2][m2][j]) - 0.35355339059327373*ddh[8][1][m1][j]*h[8][l2][m2][j] + dh[2][1][m1][j]*(h[4][l2][m2][j]/(2.*f[j]*r[j]) + (0.5*I*h[8][l2][m2][j])/(f[j]*r[j])) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][l2][m2][j]*h[9][1][m1][j])/(f_2*r_2) + h[5][l2][m2][j]*((0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j])/(f_2*r_4)) + dh[5][l2][m2][j]*(-0.35355339059327373*I*dh[9][1][m1][j] - h[1][1][m1][j]/(2.*f[j]*r[j]) + h[3][1][m1][j]/(2.*r[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + dh[9][l2][m2][j]*((-0.5*I*h[1][1][m1][j])/(f[j]*r[j]) + (0.5*I*h[3][1][m1][j])/r[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + h[4][l2][m2][j]*(0.35355339059327373*I*ddh[8][1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m1][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][1][m1][j])/(f_2*r_2)) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j]*h[9][l2][m2][j])/(f_2*r_4) + h[3][1][m1][j]*((sqrtl2*h[3][l2][m2][j])/(2.*r_2*sqrtl1) - (0.5*I*(m1d - m2d)*Omega*h[4][l2][m2][j])/(f[j]*r[j]) + (3.0*h[5][l2][m2][j])/(2.*r_2) + ((m1d - m2d)*Omega*h[8][l2][m2][j])/(2.*f[j]*r[j]) + (1.5*I*h[9][l2][m2][j])/r_2) + h[5][1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][l2][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][l2][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][l2][m2][j])/(f_2*r_4)) + dh[8][1][m1][j]*(-0.35355339059327373*dh[8][l2][m2][j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[5][l2][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][l2][m2][j])/f[j]) + dh[4][1][m1][j]*(-0.35355339059327373*dh[4][l2][m2][j] - 0.35355339059327373*I*dh[8][l2][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][l2][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][l2][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[9][l2][m2][j])/f[j]) + dh[3][1][m1][j]*(-h[5][l2][m2][j]/(2.*r[j]) - (0.5*I*h[9][l2][m2][j])/r[j]) + h[2][1][m1][j]*(-(sqrtl2*h[2][l2][m2][j])/(2.*f_2*r_2*sqrtl1) + ((-2. + f[j]*r[j])*h[4][l2][m2][j])/(2.*f_2*r_3) - (0.5*I*(m1d + m2d)*Omega*h[5][l2][m2][j])/(f_2*r[j]) + (0.5*I*(-2. + f[j]*r[j])*h[8][l2][m2][j])/(f_2*r_3) + ((m1d + m2d)*Omega*h[9][l2][m2][j])/(2.*f_2*r[j])) + dh[1][1][m1][j]*(-h[5][l2][m2][j]/(2.*f[j]*r[j]) - (0.5*I*h[9][l2][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((sqrtl2*h[1][l2][m2][j])/(2.*f_2*r_2*sqrtl1) + (0.5*I*(m1d + m2d)*Omega*h[4][l2][m2][j])/(f_2*r[j]) + ((2. - f[j]*r[j])*h[5][l2][m2][j])/(2.*f_2*r_3) - ((m1d + m2d)*Omega*h[8][l2][m2][j])/(2.*f_2*r[j]) - (0.5*I*(-2. + f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_3)) + dh[5][1][m1][j]*(0.35355339059327373*dh[5][l2][m2][j] + 0.35355339059327373*I*dh[9][l2][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][l2][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][l2][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[8][l2][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][l2][m2][j])/(r_2*f[j])) + dh[9][1][m1][j]*(0.35355339059327373*dh[9][l2][m2][j] - (0.35355339059327373*m1d*Omega*h[4][l2][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][l2][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][l2][m2][j])/(r_2*f[j])) + h[4][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][l2][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_2)) + h[8][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_2))) + c2*(dh[8][l2][m2][j]*((-0.5*I*h[2][1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + dh[4][l2][m2][j]*(-0.35355339059327373*I*dh[8][1][m1][j] + h[2][1][m1][j]/(2.*f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m1][j])/(r_2*f[j])) + ddh[4][1][m1][j]*(-0.35355339059327373*h[4][l2][m2][j] + 0.35355339059327373*I*h[8][l2][m2][j]) - 0.35355339059327373*ddh[8][1][m1][j]*h[8][l2][m2][j] + dh[2][1][m1][j]*(h[4][l2][m2][j]/(2.*f[j]*r[j]) - (0.5*I*h[8][l2][m2][j])/(f[j]*r[j])) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][l2][m2][j]*h[9][1][m1][j])/(f_2*r_2) + h[5][l2][m2][j]*((-0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j])/(f_2*r_4)) + dh[5][l2][m2][j]*(0.35355339059327373*I*dh[9][1][m1][j] - h[1][1][m1][j]/(2.*f[j]*r[j]) + h[3][1][m1][j]/(2.*r[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + dh[9][l2][m2][j]*((0.5*I*h[1][1][m1][j])/(f[j]*r[j]) - (0.5*I*h[3][1][m1][j])/r[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m1][j])/(r_2*f[j])) + h[4][l2][m2][j]*(-0.35355339059327373*I*ddh[8][1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m1][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][1][m1][j])/(f_2*r_2)) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m1][j]*h[9][l2][m2][j])/(f_2*r_4) + h[3][1][m1][j]*((sqrtl2*h[3][l2][m2][j])/(2.*r_2*sqrtl1) - (0.5*I*(m1d - m2d)*Omega*h[4][l2][m2][j])/(f[j]*r[j]) + (3.0*h[5][l2][m2][j])/(2.*r_2) + ((-m1d + m2d)*Omega*h[8][l2][m2][j])/(2.*f[j]*r[j]) - (1.5*I*h[9][l2][m2][j])/r_2) + h[5][1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][l2][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][l2][m2][j])/(f_2*r_4)) + dh[4][1][m1][j]*(-0.35355339059327373*dh[4][l2][m2][j] + 0.35355339059327373*I*dh[8][l2][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][l2][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[9][l2][m2][j])/f[j]) + dh[8][1][m1][j]*(-0.35355339059327373*dh[8][l2][m2][j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][l2][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[5][l2][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][l2][m2][j])/f[j]) + dh[3][1][m1][j]*(-h[5][l2][m2][j]/(2.*r[j]) + (0.5*I*h[9][l2][m2][j])/r[j]) + h[2][1][m1][j]*(-(sqrtl2*h[2][l2][m2][j])/(2.*f_2*r_2*sqrtl1) + ((-2. + f[j]*r[j])*h[4][l2][m2][j])/(2.*f_2*r_3) - (0.5*I*(m1d + m2d)*Omega*h[5][l2][m2][j])/(f_2*r[j]) - (0.5*I*(-2. + f[j]*r[j])*h[8][l2][m2][j])/(f_2*r_3) - ((m1d + m2d)*Omega*h[9][l2][m2][j])/(2.*f_2*r[j])) + dh[1][1][m1][j]*(-h[5][l2][m2][j]/(2.*f[j]*r[j]) + (0.5*I*h[9][l2][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((sqrtl2*h[1][l2][m2][j])/(2.*f_2*r_2*sqrtl1) + (0.5*I*(m1d + m2d)*Omega*h[4][l2][m2][j])/(f_2*r[j]) + ((2. - f[j]*r[j])*h[5][l2][m2][j])/(2.*f_2*r_3) + ((m1d + m2d)*Omega*h[8][l2][m2][j])/(2.*f_2*r[j]) + (0.5*I*(-2. + f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_3)) + dh[5][1][m1][j]*(0.35355339059327373*dh[5][l2][m2][j] - 0.35355339059327373*I*dh[9][l2][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][l2][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[8][l2][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][l2][m2][j])/(r_2*f[j])) + dh[9][1][m1][j]*(0.35355339059327373*dh[9][l2][m2][j] + (0.35355339059327373*m1d*Omega*h[4][l2][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][l2][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][l2][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][l2][m2][j])/(r_2*f[j])) + h[8][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_2)) + h[4][1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][l2][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][l2][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][l2][m2][j])/(f_2*r_2)));
    }
  } else if(l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = c1*((-0.35355339059327373*I*m1d*Omega*dh[3][1][m2][j]*h[2][l1][m1][j])/f[j] + dh[1][1][m2][j]*(-0.35355339059327373*dh[3][l1][m1][j] + (0.7071067811865475*h[1][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[2][l1][m1][j])/f_2) - 0.7071067811865475*ddh[1][l1][m1][j]*h[3][1][m2][j] - 0.7071067811865475*f[j]*ddh[3][l1][m1][j]*h[3][1][m2][j] + dh[3][l1][m1][j]*(-0.7071067811865475*f[j]*dh[3][1][m2][j] - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f[j] - (1.4142135623730951*h[3][1][m2][j])/r_2) + h[1][l1][m1][j]*((-0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[1][1][m2][j])/(f_3*r_4) + (0.7071067811865475*I*(m1d - m2d)*Omega*h[2][1][m2][j])/(f_3*r_2) + (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[3][1][m2][j])/f_2) + dh[2][l1][m1][j]*((0.7071067811865475*dh[2][1][m2][j])/f[j] + (0.35355339059327373*I*m2d*Omega*h[1][1][m2][j])/f_2 - (0.7071067811865475*h[2][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(4.*m1d + m2d)*Omega*h[3][1][m2][j])/f[j]) + h[1][1][m2][j]*((-0.7071067811865475*I*(m1d - m2d)*Omega*h[2][l1][m1][j])/(f_3*r_2) + (0.35355339059327373*m1d*m2d*Omega_2*h[3][l1][m1][j])/f_2) + dh[2][1][m2][j]*((0.35355339059327373*I*m1d*Omega*h[1][l1][m1][j])/f_2 - (0.7071067811865475*h[2][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*m1d*Omega*h[3][l1][m1][j])/f[j]) - 0.7071067811865475*f[j]*ddh[6][l1][m1][j]*h[6][1][m2][j] - (0.7071067811865475*sqrtl1*dh[5][l1][m1][j]*h[6][1][m2][j])/r[j] - (0.7071067811865475*I*m1d*sqrtl1*Omega*h[4][l1][m1][j]*h[6][1][m2][j])/(f[j]*r[j]) - (0.7071067811865475*sqrtl1*h[5][l1][m1][j]*h[6][1][m2][j])/r_2 + h[3][l1][m1][j]*((-0.7071067811865475*m1d*(m1d + m2d)*Omega_2*h[3][1][m2][j])/f[j] - (0.7071067811865475*l1*(1 + l1)*h[6][1][m2][j])/r_2) + dh[1][l1][m1][j]*((-0.7071067811865475*dh[1][1][m2][j])/f[j] - 0.35355339059327373*dh[3][1][m2][j] + (0.7071067811865475*h[1][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*m2d*Omega*h[2][1][m2][j])/f_2 + (1.4142135623730951*h[6][1][m2][j])/r[j]) + h[2][l1][m1][j]*((0.7071067811865475*(4. + m1d*m2d*r_4*Omega_2 + 4.*f[j]*r[j])*h[2][1][m2][j])/(f_3*r_4) + (1.4142135623730951*I*m1d*Omega*h[3][1][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[6][1][m2][j])/(f[j]*r[j])) + dh[6][l1][m1][j]*(-0.35355339059327373*f[j]*dh[6][1][m2][j] - (0.7071067811865475*(2. + f[j]*r[j])*h[6][1][m2][j])/r_2) - (0.7071067811865475*f[j]*dh[6][1][m2][j]*h[6][l1][m1][j])/r[j] - (0.35355339059327373*m1d*(2.*m1d + m2d)*Omega_2*h[6][1][m2][j]*h[6][l1][m1][j])/f[j] + (sqrtl1*h[8][1][m2][j]*h[8][l1][m1][j])/(2.*r_2*f[j]) - (sqrtl1*h[9][1][m2][j]*h[9][l1][m1][j])/(2.*r_2*f[j])) + c2*(ddh[4][l1][m1][j]*(-0.35355339059327373*h[4][1][m2][j] + 0.35355339059327373*I*h[8][1][m2][j]) - 0.35355339059327373*ddh[8][l1][m1][j]*h[8][1][m2][j] + dh[2][l1][m1][j]*((0.35355339059327373*sqrtl1*h[4][1][m2][j])/(f[j]*r[j]) - (0.35355339059327373*I*sqrtl1*h[8][1][m2][j])/(f[j]*r[j])) + dh[8][1][m2][j]*((-0.35355339059327373*I*sqrtl1*h[2][l1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][l1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][l1][m1][j])/(r_2*f[j])) + dh[4][1][m2][j]*(-0.35355339059327373*I*dh[8][l1][m1][j] + (0.35355339059327373*sqrtl1*h[2][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][l1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][l1][m1][j])/(r_2*f[j])) + h[3][l1][m1][j]*((sqrtl1*h[3][1][m2][j])/(2.*r_2) - (0.35355339059327373*I*(m1d - m2d)*sqrtl1*Omega*h[4][1][m2][j])/(f[j]*r[j]) + (1.0606601717798212*sqrtl1*h[5][1][m2][j])/r_2 + (0.35355339059327373*(-m1d + m2d)*sqrtl1*Omega*h[8][1][m2][j])/(f[j]*r[j]) - (1.0606601717798212*I*sqrtl1*h[9][1][m2][j])/r_2) + h[5][l1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][1][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j])/(f_2*r_4)) + dh[4][l1][m1][j]*(-0.35355339059327373*dh[4][1][m2][j] + 0.35355339059327373*I*dh[8][1][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[8][l1][m1][j]*(-0.35355339059327373*dh[8][1][m2][j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[3][l1][m1][j]*((-0.35355339059327373*sqrtl1*h[5][1][m2][j])/r[j] + (0.35355339059327373*I*sqrtl1*h[9][1][m2][j])/r[j]) + h[2][l1][m1][j]*(-(sqrtl1*h[2][1][m2][j])/(2.*f_2*r_2) + (0.35355339059327373*sqrtl1*(-2. + f[j]*r[j])*h[4][1][m2][j])/(f_2*r_3) - (0.35355339059327373*I*(m1d + m2d)*sqrtl1*Omega*h[5][1][m2][j])/(f_2*r[j]) - (0.35355339059327373*I*sqrtl1*(-2. + f[j]*r[j])*h[8][1][m2][j])/(f_2*r_3) - (0.35355339059327373*(m1d + m2d)*sqrtl1*Omega*h[9][1][m2][j])/(f_2*r[j])) + dh[1][l1][m1][j]*((-0.35355339059327373*sqrtl1*h[5][1][m2][j])/(f[j]*r[j]) + (0.35355339059327373*I*sqrtl1*h[9][1][m2][j])/(f[j]*r[j])) + h[1][l1][m1][j]*((sqrtl1*h[1][1][m2][j])/(2.*f_2*r_2) + (0.35355339059327373*I*(m1d + m2d)*sqrtl1*Omega*h[4][1][m2][j])/(f_2*r[j]) - (0.35355339059327373*sqrtl1*(-2. + f[j]*r[j])*h[5][1][m2][j])/(f_2*r_3) + (0.35355339059327373*(m1d + m2d)*sqrtl1*Omega*h[8][1][m2][j])/(f_2*r[j]) + (0.35355339059327373*I*sqrtl1*(-2. + f[j]*r[j])*h[9][1][m2][j])/(f_2*r_3)) + dh[5][l1][m1][j]*(0.35355339059327373*dh[5][1][m2][j] - 0.35355339059327373*I*dh[9][1][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[8][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + dh[9][l1][m1][j]*(0.35355339059327373*dh[9][1][m2][j] + (0.35355339059327373*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + h[8][l1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + h[4][l1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][1][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j]*h[9][l1][m1][j])/(f_2*r_2) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j]*h[9][l1][m1][j])/(f_2*r_4) + h[5][1][m2][j]*((-0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][l1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][l1][m1][j])/(f_2*r_4)) + dh[5][1][m2][j]*(0.35355339059327373*I*dh[9][l1][m1][j] - (0.35355339059327373*sqrtl1*h[1][l1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*sqrtl1*h[3][l1][m1][j])/r[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][l1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][l1][m1][j])/(r_2*f[j])) + dh[9][1][m2][j]*((0.35355339059327373*I*sqrtl1*h[1][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*sqrtl1*h[3][l1][m1][j])/r[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][l1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][l1][m1][j])/(r_2*f[j])) + h[4][1][m2][j]*(-0.35355339059327373*I*ddh[8][l1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][l1][m1][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][l1][m1][j])/(f_2*r_2))) + c3*(ddh[4][l1][m1][j]*(-0.35355339059327373*h[4][1][m2][j] - 0.35355339059327373*I*h[8][1][m2][j]) - 0.35355339059327373*ddh[8][l1][m1][j]*h[8][1][m2][j] + dh[2][l1][m1][j]*((0.35355339059327373*sqrtl1*h[4][1][m2][j])/(f[j]*r[j]) + (0.35355339059327373*I*sqrtl1*h[8][1][m2][j])/(f[j]*r[j])) + dh[8][1][m2][j]*((0.35355339059327373*I*sqrtl1*h[2][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][l1][m1][j])/(r_2*f[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][l1][m1][j])/(r_2*f[j])) + dh[4][1][m2][j]*(0.35355339059327373*I*dh[8][l1][m1][j] + (0.35355339059327373*sqrtl1*h[2][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][l1][m1][j])/(r_2*f[j]) + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][l1][m1][j])/(r_2*f[j])) + h[3][l1][m1][j]*((sqrtl1*h[3][1][m2][j])/(2.*r_2) - (0.35355339059327373*I*(m1d - m2d)*sqrtl1*Omega*h[4][1][m2][j])/(f[j]*r[j]) + (1.0606601717798212*sqrtl1*h[5][1][m2][j])/r_2 + (0.35355339059327373*(m1d - m2d)*sqrtl1*Omega*h[8][1][m2][j])/(f[j]*r[j]) + (1.0606601717798212*I*sqrtl1*h[9][1][m2][j])/r_2) + h[5][l1][m1][j]*((0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[5][1][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j])/(f_2*r_4)) + dh[8][l1][m1][j]*(-0.35355339059327373*dh[8][1][m2][j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[4][l1][m1][j]*(-0.35355339059327373*dh[4][1][m2][j] - 0.35355339059327373*I*dh[8][1][m2][j] - (0.35355339059327373*(-1 + f[j]*r[j])*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[5][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[8][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[9][1][m2][j])/f[j]) + dh[3][l1][m1][j]*((-0.35355339059327373*sqrtl1*h[5][1][m2][j])/r[j] - (0.35355339059327373*I*sqrtl1*h[9][1][m2][j])/r[j]) + h[2][l1][m1][j]*(-(sqrtl1*h[2][1][m2][j])/(2.*f_2*r_2) + (0.35355339059327373*sqrtl1*(-2. + f[j]*r[j])*h[4][1][m2][j])/(f_2*r_3) - (0.35355339059327373*I*(m1d + m2d)*sqrtl1*Omega*h[5][1][m2][j])/(f_2*r[j]) + (0.35355339059327373*I*sqrtl1*(-2. + f[j]*r[j])*h[8][1][m2][j])/(f_2*r_3) + (0.35355339059327373*(m1d + m2d)*sqrtl1*Omega*h[9][1][m2][j])/(f_2*r[j])) + dh[1][l1][m1][j]*((-0.35355339059327373*sqrtl1*h[5][1][m2][j])/(f[j]*r[j]) - (0.35355339059327373*I*sqrtl1*h[9][1][m2][j])/(f[j]*r[j])) + h[1][l1][m1][j]*((sqrtl1*h[1][1][m2][j])/(2.*f_2*r_2) + (0.35355339059327373*I*(m1d + m2d)*sqrtl1*Omega*h[4][1][m2][j])/(f_2*r[j]) - (0.35355339059327373*sqrtl1*(-2. + f[j]*r[j])*h[5][1][m2][j])/(f_2*r_3) - (0.35355339059327373*(m1d + m2d)*sqrtl1*Omega*h[8][1][m2][j])/(f_2*r[j]) - (0.35355339059327373*I*sqrtl1*(-2. + f[j]*r[j])*h[9][1][m2][j])/(f_2*r_3)) + dh[5][l1][m1][j]*(0.35355339059327373*dh[5][1][m2][j] + 0.35355339059327373*I*dh[9][1][m2][j] - (0.35355339059327373*I*m1d*Omega*h[4][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + dh[9][l1][m1][j]*(0.35355339059327373*dh[9][1][m2][j] - (0.35355339059327373*m1d*Omega*h[4][1][m2][j])/f[j] - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*m1d*Omega*h[8][1][m2][j])/f[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][1][m2][j])/(r_2*f[j])) + h[4][l1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[4][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[5][1][m2][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) - (0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + h[8][l1][m1][j]*((-0.35355339059327373*(2. + m1d*m2d*r_4*Omega_2)*h[8][1][m2][j])/(f_2*r_4) + (0.35355339059327373*I*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[9][1][m2][j])/(f_2*r_2)) + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[8][1][m2][j]*h[9][l1][m1][j])/(f_2*r_2) + (0.35355339059327373*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][1][m2][j]*h[9][l1][m1][j])/(f_2*r_4) + h[5][1][m2][j]*((0.35355339059327373*Omega*(m1d - m2d + m1d*f[j]*r[j])*h[8][l1][m1][j])/(f_2*r_2) - (0.35355339059327373*I*(2. + 2.*f_2*r_2 + m1d*m1d*r_4*Omega_2 + m1d*m2d*r_4*Omega_2)*h[9][l1][m1][j])/(f_2*r_4)) + dh[5][1][m2][j]*(-0.35355339059327373*I*dh[9][l1][m1][j] - (0.35355339059327373*sqrtl1*h[1][l1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*sqrtl1*h[3][l1][m1][j])/r[j] + (0.35355339059327373*(-1 + f[j]*r[j])*h[5][l1][m1][j])/(r_2*f[j]) - (0.35355339059327373*I*(-1 + f[j]*r[j])*h[9][l1][m1][j])/(r_2*f[j])) + dh[9][1][m2][j]*((-0.35355339059327373*I*sqrtl1*h[1][l1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*I*sqrtl1*h[3][l1][m1][j])/r[j] + (0.35355339059327373*I*(-1 + f[j]*r[j])*h[5][l1][m1][j])/(r_2*f[j]) + (0.35355339059327373*(-1 + f[j]*r[j])*h[9][l1][m1][j])/(r_2*f[j])) + h[4][1][m2][j]*(0.35355339059327373*I*ddh[8][l1][m1][j] + (0.35355339059327373*I*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[5][l1][m1][j])/(f_2*r_2) + (0.35355339059327373*I*(2. + m1d*m2d*r_4*Omega_2)*h[8][l1][m1][j])/(f_2*r_4) + (0.35355339059327373*Omega*(m1d + m2d - m1d*f[j]*r[j])*h[9][l1][m1][j])/(f_2*r_2)));
    }
  } else {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double r_4 = r_2*r_2;
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      double f_4 = f_2*f_2;

      ricci[j] = (0.35355339059327373*c1*(2.*h[2][l1][m1][j]*(-(r_2*(f[j]*dh[2][l2][m2][j] - I*m2d*Omega*h[1][l2][m2][j])) + 4.*h[2][l2][m2][j]) + 2.*h[1][l1][m1][j]*(-4.*h[1][l2][m2][j] + r_2*(f[j]*dh[1][l2][m2][j] - I*m2d*Omega*h[2][l2][m2][j])) + r_2*(-(f_3*r_2*(dh[1][l2][m2][j]*dh[3][l1][m1][j] + dh[1][l1][m1][j]*dh[3][l2][m2][j])) - 2.*m1d*m2d*r_2*Omega_2*h[1][l1][m1][j]*h[1][l2][m2][j] - 2.0*I*m1d*Omega*h[1][l2][m2][j]*h[2][l1][m1][j] + 2.0*I*m1d*Omega*h[1][l1][m1][j]*h[2][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[2][l1][m1][j]*h[2][l2][m2][j] + f[j]*(2.*dh[1][l1][m1][j]*h[1][l2][m2][j] - 2.*dh[2][l1][m1][j]*h[2][l2][m2][j] - r_2*(I*m1d*Omega*dh[1][l2][m2][j]*h[2][l1][m1][j] + I*m2d*Omega*dh[1][l1][m1][j]*h[2][l2][m2][j] - I*m2d*Omega*h[1][l2][m2][j]*(dh[2][l1][m1][j] - I*m1d*Omega*h[3][l1][m1][j]) - I*m1d*Omega*h[1][l1][m1][j]*(dh[2][l2][m2][j] - I*m2d*Omega*h[3][l2][m2][j]))) - f_4*r[j]*(2.*r[j]*dh[3][l1][m1][j]*dh[3][l2][m2][j] + r[j]*dh[6][l1][m1][j]*dh[6][l2][m2][j] + 2.*dh[6][l2][m2][j]*h[6][l1][m1][j] - 2.*dh[6][l1][m1][j]*h[6][l2][m2][j]) + f_2*(r_2*(-2.*dh[1][l1][m1][j]*dh[1][l2][m2][j] + 2.*dh[2][l1][m1][j]*dh[2][l2][m2][j] - I*m1d*Omega*dh[3][l2][m2][j]*h[2][l1][m1][j] - I*m2d*Omega*dh[3][l1][m1][j]*h[2][l2][m2][j] - I*m2d*Omega*dh[2][l1][m1][j]*h[3][l2][m2][j] - I*m1d*Omega*h[3][l1][m1][j]*(dh[2][l2][m2][j] - 2.0*I*m2d*Omega*h[3][l2][m2][j]) - m1d*m2d*Omega_2*h[6][l1][m1][j]*h[6][l2][m2][j]) + sqrtl2*h[8][l1][m1][j]*h[8][l2][m2][j] - sqrtl2*h[9][l1][m1][j]*h[9][l2][m2][j]))))/(f_3*r_4) + (0.35355339059327373*c2*(-(f_2*r_4*dh[4][l1][m1][j]*dh[4][l2][m2][j]) + f_2*r_4*dh[5][l1][m1][j]*dh[5][l2][m2][j] - I*f_2*r_4*dh[4][l2][m2][j]*dh[8][l1][m1][j] + I*f_2*r_4*dh[4][l1][m1][j]*dh[8][l2][m2][j] - f_2*r_4*dh[8][l1][m1][j]*dh[8][l2][m2][j] + I*f_2*r_4*dh[5][l2][m2][j]*dh[9][l1][m1][j] - I*f_2*r_4*dh[5][l1][m1][j]*dh[9][l2][m2][j] + f_2*r_4*dh[9][l1][m1][j]*dh[9][l2][m2][j] - r_3*sqrtl1*f[j]*dh[5][l2][m2][j]*h[1][l1][m1][j] + I*r_3*sqrtl1*f[j]*dh[9][l2][m2][j]*h[1][l1][m1][j] + r_2*sqrtl2*h[1][l1][m1][j]*h[1][l2][m2][j] + r_3*sqrtl1*f[j]*dh[4][l2][m2][j]*h[2][l1][m1][j] - I*r_3*sqrtl1*f[j]*dh[8][l2][m2][j]*h[2][l1][m1][j] - r_2*sqrtl2*h[2][l1][m1][j]*h[2][l2][m2][j] + f_2*r_3*sqrtl1*dh[5][l2][m2][j]*h[3][l1][m1][j] - I*f_2*r_3*sqrtl1*dh[9][l2][m2][j]*h[3][l1][m1][j] + f_2*r_2*sqrtl2*h[3][l1][m1][j]*h[3][l2][m2][j] + r_2*f[j]*dh[4][l1][m1][j]*h[4][l2][m2][j] + I*r_2*f[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] + I*m2d*r_3*sqrtl1*Omega*h[1][l1][m1][j]*h[4][l2][m2][j] + 2.*r_2*sqrtl1*f[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - 2.*sqrtl1*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] + I*m2d*r_3*sqrtl1*Omega*f[j]*h[3][l1][m1][j]*h[4][l2][m2][j] - m1d*m2d*r_4*Omega_2*h[4][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] + I*m1d*r_3*Omega*f[j]*h[4][l2][m2][j]*h[5][l1][m1][j] + f_2*r_3*dh[5][l1][m1][j]*h[5][l2][m2][j] - r_2*f[j]*dh[5][l1][m1][j]*h[5][l2][m2][j] + I*f_2*r_3*dh[9][l1][m1][j]*h[5][l2][m2][j] - I*r_2*f[j]*dh[9][l1][m1][j]*h[5][l2][m2][j] - 2.*r_2*sqrtl1*f[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + 2.*sqrtl1*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] - I*m2d*r_3*sqrtl1*Omega*h[2][l1][m1][j]*h[5][l2][m2][j] + 2.*f_2*r_2*sqrtl1*h[3][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*Omega*h[4][l1][m1][j]*h[5][l2][m2][j] + m1d*m2d*r_4*Omega_2*h[5][l1][m1][j]*h[5][l2][m2][j] - I*f_2*r_3*dh[4][l2][m2][j]*h[8][l1][m1][j] + I*r_2*f[j]*dh[4][l2][m2][j]*h[8][l1][m1][j] - f_2*r_3*dh[8][l2][m2][j]*h[8][l1][m1][j] + r_2*f[j]*dh[8][l2][m2][j]*h[8][l1][m1][j] - 2.0*I*h[4][l2][m2][j]*h[8][l1][m1][j] - I*f_2*r_2*h[4][l2][m2][j]*h[8][l1][m1][j] - I*m1d*m2d*r_4*Omega_2*h[4][l2][m2][j]*h[8][l1][m1][j] + 2.0*I*f[j]*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] - m1d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] + m2d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] - I*r_2*f[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] + r_2*f[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] + m2d*r_3*sqrtl1*Omega*h[1][l1][m1][j]*h[8][l2][m2][j] - 2.0*I*r_2*sqrtl1*f[j]*h[2][l1][m1][j]*h[8][l2][m2][j] + 2.0*I*sqrtl1*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] + m2d*r_3*sqrtl1*Omega*f[j]*h[3][l1][m1][j]*h[8][l2][m2][j] + I*m1d*m2d*r_4*Omega_2*h[4][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] + m1d*r_3*Omega*f[j]*h[5][l1][m1][j]*h[8][l2][m2][j] - 2.*h[8][l1][m1][j]*h[8][l2][m2][j] - f_2*r_2*h[8][l1][m1][j]*h[8][l2][m2][j] - m1d*m2d*r_4*Omega_2*h[8][l1][m1][j]*h[8][l2][m2][j] + 2.*f[j]*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + I*f_2*r_3*dh[5][l2][m2][j]*h[9][l1][m1][j] - I*r_2*f[j]*dh[5][l2][m2][j]*h[9][l1][m1][j] + f_2*r_3*dh[9][l2][m2][j]*h[9][l1][m1][j] - r_2*f[j]*dh[9][l2][m2][j]*h[9][l1][m1][j] + m1d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] - m2d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] - m1d*r_3*Omega*f[j]*h[4][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*h[5][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*f_2*r_2*h[5][l2][m2][j]*h[9][l1][m1][j] + I*m1d*m2d*r_4*Omega_2*h[5][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*f[j]*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*m1d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] + I*m2d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] + I*m1d*r_3*Omega*f[j]*h[8][l2][m2][j]*h[9][l1][m1][j] - I*f_2*r_3*dh[5][l1][m1][j]*h[9][l2][m2][j] + I*r_2*f[j]*dh[5][l1][m1][j]*h[9][l2][m2][j] + f_2*r_3*dh[9][l1][m1][j]*h[9][l2][m2][j] - r_2*f[j]*dh[9][l1][m1][j]*h[9][l2][m2][j] + 2.0*I*r_2*sqrtl1*f[j]*h[1][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*sqrtl1*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] - m2d*r_3*sqrtl1*Omega*h[2][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*f_2*r_2*sqrtl1*h[3][l1][m1][j]*h[9][l2][m2][j] + m1d*r_2*Omega*h[4][l1][m1][j]*h[9][l2][m2][j] - I*m1d*m2d*r_4*Omega_2*h[5][l1][m1][j]*h[9][l2][m2][j] + I*m1d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] - I*m2d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] + 2.*h[9][l1][m1][j]*h[9][l2][m2][j] + 2.*f_2*r_2*h[9][l1][m1][j]*h[9][l2][m2][j] + m1d*m2d*r_4*Omega_2*h[9][l1][m1][j]*h[9][l2][m2][j] - 2.*f[j]*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] + h[5][l1][m1][j]*(2.*(1 + f_2*r_2 - f[j]*r[j])*h[5][l2][m2][j] - I*(r_2*(f[j]*(-1 + f[j]*r[j])*(I*dh[5][l2][m2][j] + dh[9][l2][m2][j]) - m2d*Omega*h[4][l2][m2][j] + I*m2d*Omega*h[8][l2][m2][j]) + 2.*(1 + f_2*r_2 - f[j]*r[j])*h[9][l2][m2][j])) + h[4][l1][m1][j]*((-2. - f_2*r_2 + 2.*f[j]*r[j])*h[4][l2][m2][j] + I*((2. + f_2*r_2 - 2.*f[j]*r[j])*h[8][l2][m2][j] + r_2*(f[j]*(-1 + f[j]*r[j])*(I*dh[4][l2][m2][j] + dh[8][l2][m2][j]) - m2d*Omega*h[5][l2][m2][j] + I*m2d*Omega*h[9][l2][m2][j])))))/(f_2*r_4) + (0.35355339059327373*c3*(-(f_2*r_4*dh[4][l1][m1][j]*dh[4][l2][m2][j]) + f_2*r_4*dh[5][l1][m1][j]*dh[5][l2][m2][j] + I*f_2*r_4*dh[4][l2][m2][j]*dh[8][l1][m1][j] - I*f_2*r_4*dh[4][l1][m1][j]*dh[8][l2][m2][j] - f_2*r_4*dh[8][l1][m1][j]*dh[8][l2][m2][j] - I*f_2*r_4*dh[5][l2][m2][j]*dh[9][l1][m1][j] + I*f_2*r_4*dh[5][l1][m1][j]*dh[9][l2][m2][j] + f_2*r_4*dh[9][l1][m1][j]*dh[9][l2][m2][j] - r_3*sqrtl1*f[j]*dh[5][l2][m2][j]*h[1][l1][m1][j] - I*r_3*sqrtl1*f[j]*dh[9][l2][m2][j]*h[1][l1][m1][j] + r_2*sqrtl2*h[1][l1][m1][j]*h[1][l2][m2][j] + r_3*sqrtl1*f[j]*dh[4][l2][m2][j]*h[2][l1][m1][j] + I*r_3*sqrtl1*f[j]*dh[8][l2][m2][j]*h[2][l1][m1][j] - r_2*sqrtl2*h[2][l1][m1][j]*h[2][l2][m2][j] + f_2*r_3*sqrtl1*dh[5][l2][m2][j]*h[3][l1][m1][j] + I*f_2*r_3*sqrtl1*dh[9][l2][m2][j]*h[3][l1][m1][j] + f_2*r_2*sqrtl2*h[3][l1][m1][j]*h[3][l2][m2][j] + r_2*f[j]*dh[4][l1][m1][j]*h[4][l2][m2][j] - I*r_2*f[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] + I*m2d*r_3*sqrtl1*Omega*h[1][l1][m1][j]*h[4][l2][m2][j] + 2.*r_2*sqrtl1*f[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - 2.*sqrtl1*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] + I*m2d*r_3*sqrtl1*Omega*f[j]*h[3][l1][m1][j]*h[4][l2][m2][j] - m1d*m2d*r_4*Omega_2*h[4][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] + I*m1d*r_3*Omega*f[j]*h[4][l2][m2][j]*h[5][l1][m1][j] + f_2*r_3*dh[5][l1][m1][j]*h[5][l2][m2][j] - r_2*f[j]*dh[5][l1][m1][j]*h[5][l2][m2][j] - I*f_2*r_3*dh[9][l1][m1][j]*h[5][l2][m2][j] + I*r_2*f[j]*dh[9][l1][m1][j]*h[5][l2][m2][j] - 2.*r_2*sqrtl1*f[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + 2.*sqrtl1*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] - I*m2d*r_3*sqrtl1*Omega*h[2][l1][m1][j]*h[5][l2][m2][j] + 2.*f_2*r_2*sqrtl1*h[3][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*Omega*h[4][l1][m1][j]*h[5][l2][m2][j] + m1d*m2d*r_4*Omega_2*h[5][l1][m1][j]*h[5][l2][m2][j] + I*f_2*r_3*dh[4][l2][m2][j]*h[8][l1][m1][j] - I*r_2*f[j]*dh[4][l2][m2][j]*h[8][l1][m1][j] - f_2*r_3*dh[8][l2][m2][j]*h[8][l1][m1][j] + r_2*f[j]*dh[8][l2][m2][j]*h[8][l1][m1][j] + 2.0*I*h[4][l2][m2][j]*h[8][l1][m1][j] + I*f_2*r_2*h[4][l2][m2][j]*h[8][l1][m1][j] + I*m1d*m2d*r_4*Omega_2*h[4][l2][m2][j]*h[8][l1][m1][j] - 2.0*I*f[j]*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] + m1d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] - m2d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] + I*r_2*f[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] + r_2*f[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] - m2d*r_3*sqrtl1*Omega*h[1][l1][m1][j]*h[8][l2][m2][j] + 2.0*I*r_2*sqrtl1*f[j]*h[2][l1][m1][j]*h[8][l2][m2][j] - 2.0*I*sqrtl1*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] - m2d*r_3*sqrtl1*Omega*f[j]*h[3][l1][m1][j]*h[8][l2][m2][j] - I*m1d*m2d*r_4*Omega_2*h[4][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] - m1d*r_3*Omega*f[j]*h[5][l1][m1][j]*h[8][l2][m2][j] - 2.*h[8][l1][m1][j]*h[8][l2][m2][j] - f_2*r_2*h[8][l1][m1][j]*h[8][l2][m2][j] - m1d*m2d*r_4*Omega_2*h[8][l1][m1][j]*h[8][l2][m2][j] + 2.*f[j]*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] - I*f_2*r_3*dh[5][l2][m2][j]*h[9][l1][m1][j] + I*r_2*f[j]*dh[5][l2][m2][j]*h[9][l1][m1][j] + f_2*r_3*dh[9][l2][m2][j]*h[9][l1][m1][j] - r_2*f[j]*dh[9][l2][m2][j]*h[9][l1][m1][j] - m1d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] + m2d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] + m1d*r_3*Omega*f[j]*h[4][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*h[5][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*f_2*r_2*h[5][l2][m2][j]*h[9][l1][m1][j] - I*m1d*m2d*r_4*Omega_2*h[5][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*f[j]*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*m1d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] + I*m2d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] + I*m1d*r_3*Omega*f[j]*h[8][l2][m2][j]*h[9][l1][m1][j] + I*f_2*r_3*dh[5][l1][m1][j]*h[9][l2][m2][j] - I*r_2*f[j]*dh[5][l1][m1][j]*h[9][l2][m2][j] + f_2*r_3*dh[9][l1][m1][j]*h[9][l2][m2][j] - r_2*f[j]*dh[9][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*r_2*sqrtl1*f[j]*h[1][l1][m1][j]*h[9][l2][m2][j] + 2.0*I*sqrtl1*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] + m2d*r_3*sqrtl1*Omega*h[2][l1][m1][j]*h[9][l2][m2][j] + 2.0*I*f_2*r_2*sqrtl1*h[3][l1][m1][j]*h[9][l2][m2][j] - m1d*r_2*Omega*h[4][l1][m1][j]*h[9][l2][m2][j] + I*m1d*m2d*r_4*Omega_2*h[5][l1][m1][j]*h[9][l2][m2][j] + I*m1d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] - I*m2d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] + 2.*h[9][l1][m1][j]*h[9][l2][m2][j] + 2.*f_2*r_2*h[9][l1][m1][j]*h[9][l2][m2][j] + m1d*m2d*r_4*Omega_2*h[9][l1][m1][j]*h[9][l2][m2][j] - 2.*f[j]*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] + h[5][l1][m1][j]*(2.*(1 + f_2*r_2 - f[j]*r[j])*h[5][l2][m2][j] + I*(r_2*(f[j]*(-1 + f[j]*r[j])*(-1.0*I*dh[5][l2][m2][j] + dh[9][l2][m2][j]) + m2d*Omega*h[4][l2][m2][j] + I*m2d*Omega*h[8][l2][m2][j]) + 2.*(1 + f_2*r_2 - f[j]*r[j])*h[9][l2][m2][j])) + h[4][l1][m1][j]*((-2. - f_2*r_2 + 2.*f[j]*r[j])*h[4][l2][m2][j] - I*((2. + f_2*r_2 - 2.*f[j]*r[j])*h[8][l2][m2][j] + r_2*(f[j]*(-1 + f[j]*r[j])*(-1.0*I*dh[4][l2][m2][j] + dh[8][l2][m2][j]) + m2d*Omega*h[5][l2][m2][j] + I*m2d*Omega*h[9][l2][m2][j])))))/(f_2*r_4) + (0.17677669529663687*c5*(r[j]*(-1.0*I*m1d*Omega*h[7][l1][m1][j] + m1d*Omega*h[10][l1][m1][j])*(-1.0*I*m2d*Omega*h[7][l2][m2][j] - m2d*Omega*h[10][l2][m2][j]) + f_2*(2.*(dh[7][l1][m1][j] + I*dh[10][l1][m1][j])*h[7][l2][m2][j] + (-dh[7][l2][m2][j] + I*dh[10][l2][m2][j])*(r[j]*dh[7][l1][m1][j] + I*r[j]*dh[10][l1][m1][j] + 2.*h[7][l1][m1][j] + 2.0*I*h[10][l1][m1][j]) + 2.*(-1.0*I*dh[7][l1][m1][j] + dh[10][l1][m1][j])*h[10][l2][m2][j])))/(f[j]*r[j]) + (0.17677669529663687*c4*(r[j]*(-1.0*I*m1d*Omega*h[7][l1][m1][j] - m1d*Omega*h[10][l1][m1][j])*(-1.0*I*m2d*Omega*h[7][l2][m2][j] + m2d*Omega*h[10][l2][m2][j]) + f_2*(2.*(dh[7][l1][m1][j] - I*dh[10][l1][m1][j])*h[7][l2][m2][j] + (-dh[7][l2][m2][j] - I*dh[10][l2][m2][j])*(r[j]*dh[7][l1][m1][j] - I*r[j]*dh[10][l1][m1][j] + 2.*h[7][l1][m1][j] - 2.0*I*h[10][l1][m1][j]) + 2.*(I*dh[7][l1][m1][j] + dh[10][l1][m1][j])*h[10][l2][m2][j])))/(f[j]*r[j]);
      ricci[j]+= (0.7071067811865475*c1*(-4.*h[1][l1][m1][j]*h[1][l2][m2][j] + 4.*h[2][l1][m1][j]*h[2][l2][m2][j] - r[j]*((-(m1d*m1d*r_2*Omega_2*h[1][l1][m1][j]) - 2.0*I*m1d*Omega*h[2][l1][m1][j])*h[3][l2][m2][j] + f_3*r[j]*(r[j]*ddh[3][l1][m1][j]*h[3][l2][m2][j] + (r[j]*ddh[6][l1][m1][j] + 2.*dh[6][l1][m1][j])*h[6][l2][m2][j]) + f_2*(r_2*ddh[1][l1][m1][j]*h[3][l2][m2][j] + 2.*dh[3][l1][m1][j]*h[3][l2][m2][j] - 2.*r[j]*dh[1][l1][m1][j]*h[6][l2][m2][j] + sqrtl1*r[j]*dh[5][l1][m1][j]*h[6][l2][m2][j] + 2.*dh[6][l1][m1][j]*h[6][l2][m2][j] + l1d*(1 + l1d)*h[3][l1][m1][j]*h[6][l2][m2][j] + sqrtl1*h[5][l1][m1][j]*h[6][l2][m2][j]) - f[j]*r[j]*(r[j]*(-2.0*I*m1d*Omega*dh[2][l1][m1][j] - m1d*m1d*Omega_2*h[3][l1][m1][j])*h[3][l2][m2][j] + (2.0*I*m1d*Omega*h[2][l1][m1][j] - I*m1d*sqrtl1*Omega*h[4][l1][m1][j] - m1d*m1d*Omega_2*r[j]*h[6][l1][m1][j])*h[6][l2][m2][j]))))/(f_2*r_3) + (0.35355339059327373*c3*(f_2*r[j]*(-(r[j]*(r[j]*ddh[4][l1][m1][j] - I*r[j]*ddh[8][l1][m1][j] + dh[4][l1][m1][j] - I*dh[8][l1][m1][j])) + h[4][l1][m1][j] - I*h[8][l1][m1][j])*(h[4][l2][m2][j] + I*h[8][l2][m2][j]) - r[j]*(h[4][l2][m2][j] + I*h[8][l2][m2][j])*(-1.0*I*m1d*sqrtl1*Omega*r[j]*h[1][l1][m1][j] - 2.0*I*m1d*Omega*h[5][l1][m1][j] - 2.*m1d*Omega*h[9][l1][m1][j]) - f_2*sqrtl1*r[j]*(r[j]*dh[3][l1][m1][j] - h[3][l1][m1][j])*(h[5][l2][m2][j] + I*h[9][l2][m2][j]) - r_2*(I*m1d*sqrtl1*Omega*h[2][l1][m1][j] + r[j]*(-(m1d*m1d*Omega_2*h[5][l1][m1][j]) + I*m1d*m1d*Omega_2*h[9][l1][m1][j]))*(h[5][l2][m2][j] + I*h[9][l2][m2][j]) + f[j]*(r_2*sqrtl1*dh[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_3*Omega*dh[5][l1][m1][j]*h[4][l2][m2][j] - m1d*r_3*Omega*dh[9][l1][m1][j]*h[4][l2][m2][j] - sqrtl1*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*sqrtl1*Omega*h[3][l1][m1][j]*h[4][l2][m2][j] - 2.0*I*m1d*r_2*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] + 3.0*I*h[4][l2][m2][j]*h[8][l1][m1][j] - 3.*h[4][l1][m1][j]*(h[4][l2][m2][j] + I*h[8][l2][m2][j]) + I*r_2*sqrtl1*dh[2][l1][m1][j]*h[8][l2][m2][j] + m1d*r_3*Omega*dh[5][l1][m1][j]*h[8][l2][m2][j] - I*m1d*r_3*Omega*dh[9][l1][m1][j]*h[8][l2][m2][j] - I*sqrtl1*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*sqrtl1*Omega*h[3][l1][m1][j]*h[8][l2][m2][j] + 2.*m1d*r_2*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] - 3.*h[8][l1][m1][j]*h[8][l2][m2][j] - 2.*m1d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] + I*h[5][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*m1d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] - h[5][l1][m1][j]*(h[5][l2][m2][j] + I*h[9][l2][m2][j]) - h[9][l1][m1][j]*h[9][l2][m2][j]) + f[j]*(-(r_2*sqrtl1*dh[1][l1][m1][j]*h[5][l2][m2][j]) - I*m1d*r_3*Omega*dh[4][l1][m1][j]*h[5][l2][m2][j] - m1d*r_3*Omega*dh[8][l1][m1][j]*h[5][l2][m2][j] + sqrtl1*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*Omega*h[4][l1][m1][j]*h[5][l2][m2][j] - I*h[4][l2][m2][j]*h[8][l1][m1][j] + m1d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] + h[4][l1][m1][j]*(h[4][l2][m2][j] + I*h[8][l2][m2][j]) + h[8][l1][m1][j]*h[8][l2][m2][j] - 3.0*I*h[5][l2][m2][j]*h[9][l1][m1][j] + 3.*h[5][l1][m1][j]*(h[5][l2][m2][j] + I*h[9][l2][m2][j]) - I*r_2*sqrtl1*dh[1][l1][m1][j]*h[9][l2][m2][j] + m1d*r_3*Omega*dh[4][l1][m1][j]*h[9][l2][m2][j] - I*m1d*r_3*Omega*dh[8][l1][m1][j]*h[9][l2][m2][j] + I*sqrtl1*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] - m1d*r_2*Omega*h[4][l1][m1][j]*h[9][l2][m2][j] + I*m1d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] + 3.*h[9][l1][m1][j]*h[9][l2][m2][j])))/(f_2*r_3) - (0.35355339059327373*c2*(f_2*r[j]*(r[j]*(r[j]*ddh[4][l1][m1][j] + I*r[j]*ddh[8][l1][m1][j] + dh[4][l1][m1][j] + I*dh[8][l1][m1][j]) - h[4][l1][m1][j] - I*h[8][l1][m1][j])*(h[4][l2][m2][j] - I*h[8][l2][m2][j]) + r[j]*(h[4][l2][m2][j] - I*h[8][l2][m2][j])*(-1.0*I*m1d*sqrtl1*Omega*r[j]*h[1][l1][m1][j] - 2.0*I*m1d*Omega*h[5][l1][m1][j] + 2.*m1d*Omega*h[9][l1][m1][j]) + f_2*sqrtl1*r[j]*(r[j]*dh[3][l1][m1][j] - h[3][l1][m1][j])*(h[5][l2][m2][j] - I*h[9][l2][m2][j]) + r_2*(I*m1d*sqrtl1*Omega*h[2][l1][m1][j] + r[j]*(-(m1d*m1d*Omega_2*h[5][l1][m1][j]) - I*m1d*m1d*Omega_2*h[9][l1][m1][j]))*(h[5][l2][m2][j] - I*h[9][l2][m2][j]) - f[j]*(r_2*sqrtl1*dh[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_3*Omega*dh[5][l1][m1][j]*h[4][l2][m2][j] + m1d*r_3*Omega*dh[9][l1][m1][j]*h[4][l2][m2][j] - sqrtl1*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*sqrtl1*Omega*h[3][l1][m1][j]*h[4][l2][m2][j] - 2.0*I*m1d*r_2*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] - 3.0*I*h[4][l2][m2][j]*h[8][l1][m1][j] - 3.*h[4][l1][m1][j]*(h[4][l2][m2][j] - I*h[8][l2][m2][j]) - I*r_2*sqrtl1*dh[2][l1][m1][j]*h[8][l2][m2][j] - m1d*r_3*Omega*dh[5][l1][m1][j]*h[8][l2][m2][j] - I*m1d*r_3*Omega*dh[9][l1][m1][j]*h[8][l2][m2][j] + I*sqrtl1*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*sqrtl1*Omega*h[3][l1][m1][j]*h[8][l2][m2][j] - 2.*m1d*r_2*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] - 3.*h[8][l1][m1][j]*h[8][l2][m2][j] + 2.*m1d*r_2*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] - I*h[5][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*m1d*r_2*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] - h[5][l1][m1][j]*(h[5][l2][m2][j] - I*h[9][l2][m2][j]) - h[9][l1][m1][j]*h[9][l2][m2][j]) - f[j]*(-(r_2*sqrtl1*dh[1][l1][m1][j]*h[5][l2][m2][j]) - I*m1d*r_3*Omega*dh[4][l1][m1][j]*h[5][l2][m2][j] + m1d*r_3*Omega*dh[8][l1][m1][j]*h[5][l2][m2][j] + sqrtl1*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*Omega*h[4][l1][m1][j]*h[5][l2][m2][j] + I*h[4][l2][m2][j]*h[8][l1][m1][j] - m1d*r_2*Omega*h[5][l2][m2][j]*h[8][l1][m1][j] + h[4][l1][m1][j]*(h[4][l2][m2][j] - I*h[8][l2][m2][j]) + h[8][l1][m1][j]*h[8][l2][m2][j] + 3.0*I*h[5][l2][m2][j]*h[9][l1][m1][j] + 3.*h[5][l1][m1][j]*(h[5][l2][m2][j] - I*h[9][l2][m2][j]) + I*r_2*sqrtl1*dh[1][l1][m1][j]*h[9][l2][m2][j] - m1d*r_3*Omega*dh[4][l1][m1][j]*h[9][l2][m2][j] - I*m1d*r_3*Omega*dh[8][l1][m1][j]*h[9][l2][m2][j] - I*sqrtl1*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] + m1d*r_2*Omega*h[4][l1][m1][j]*h[9][l2][m2][j] + I*m1d*r_2*Omega*h[8][l1][m1][j]*h[9][l2][m2][j] + 3.*h[9][l1][m1][j]*h[9][l2][m2][j])))/(f_2*r_3) + (0.35355339059327373*sqrtl5*c5*(-(f_2*sqrtl1*r[j]*(r[j]*(ddh[7][l1][m1][j] + I*ddh[10][l1][m1][j]) + 2.*dh[7][l1][m1][j] + 2.0*I*dh[10][l1][m1][j])) + f[j]*(sqrtl3*r[j]*dh[5][l1][m1][j] - 2.*sqrtl1*dh[7][l1][m1][j] + I*sqrtl3*r[j]*dh[9][l1][m1][j] - 2.0*I*sqrtl1*dh[10][l1][m1][j] + l1d*(1 + l1d)*sqrtl4*h[3][l1][m1][j] + sqrtl3*h[5][l1][m1][j] + I*sqrtl3*h[9][l1][m1][j]) + r[j]*(I*m1d*sqrtl3*Omega*h[4][l1][m1][j] - m1d*sqrtl3*Omega*h[8][l1][m1][j] + sqrtl1*r[j]*(-(m1d*m1d*Omega_2*h[7][l1][m1][j]) - I*m1d*m1d*Omega_2*h[10][l1][m1][j])))*(h[7][l2][m2][j] - I*h[10][l2][m2][j]))/(r_2*f[j]) + (0.35355339059327373*sqrtl5*c4*(f_2*sqrtl1*r[j]*(-(r[j]*ddh[7][l1][m1][j]) + I*r[j]*ddh[10][l1][m1][j] - 2.*dh[7][l1][m1][j] + 2.0*I*dh[10][l1][m1][j]) + f[j]*(sqrtl3*r[j]*dh[5][l1][m1][j] - 2.*sqrtl1*dh[7][l1][m1][j] - I*sqrtl3*r[j]*dh[9][l1][m1][j] + 2.0*I*sqrtl1*dh[10][l1][m1][j] + l1d*(1 + l1d)*sqrtl4*h[3][l1][m1][j] + sqrtl3*h[5][l1][m1][j] - I*sqrtl3*h[9][l1][m1][j]) + r[j]*(I*m1d*sqrtl3*Omega*h[4][l1][m1][j] + m1d*sqrtl3*Omega*h[8][l1][m1][j] + sqrtl1*r[j]*(-(m1d*m1d*Omega_2*h[7][l1][m1][j]) + I*m1d*m1d*Omega_2*h[10][l1][m1][j])))*(h[7][l2][m2][j] + I*h[10][l2][m2][j]))/(r_2*f[j]);
    }
  }

  return ricci;
}
