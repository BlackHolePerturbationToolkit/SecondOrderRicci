/*
 * Copyright 2014 Barry Wardell
 *
 * This file is distributed under the University of Illinois/NCSA
 * Open Source License. See LICENSE file for details.
 *
 */

#include <boost/multi_array.hpp>
#include <complex>
#include <math.h>

#include "Coupling.h"
#include "R2.h"

using std::complex;
using std::vector;

vector<complex<double>> R2_6(const double M, const double r0,
                     const vector<double> &r, const vector<double> &f, const vector<double> &fp,
                     const field_type &h, const field_type &dh, const field_type &ddh,
                     int l3, int m3, int l1, int m1, int l2, int m2) {
  vector<complex<double>> ricci(r.size());
  const complex<double> I(0.0, 1.0);
  const double Omega = sqrt(M/(r0*r0*r0));
  const double Omega_2 = Omega*Omega;
  const double l1d = l1, m1d = m1, l2d = l2, m2d = m2;
  const double sqrtl1 = sqrt(l1d*(1. + l1d));
  const double sqrtl2 = sqrt(l1d*(1. + l1d)*l2d*(1. + l2d));
  const double sqrtl3 = sqrt(-2. + l1d + l1d*l1d);
  const double sqrtl4 = sqrt((1. + l1d)*(1. + l2d));
  const double sqrtl5 = sqrt(l1d*l1d*l1d*l2d);
  const double sqrtl6 = sqrt(l1d*l2d*l2d*l2d);
  const double sqrtl7 = sqrt(l1d*(1. + l2d));
  const double sqrtl8 = sqrt(l1d*l2d);
  const double sqrtl9 = sqrt(-6. + l1d + l1d*l1d);
  const double sqrtl10 = sqrt(l1d*(1. + l1d)*(-2. + l2d + l2d*l2d));
  const double sqrtl11 = sqrt(l1d*l1d*l1d*(1. + l2d));
  const double sqrtl12 = 1./sqrt((1. + l1d)*(1. + l2d));
  const double sqrtl13 = sqrt(-6. + l2d + l2d*l2d);
  const double sqrtl14 = sqrt((-2. + l1d + l1d*l1d)*l2d*(1. + l2d));
  const double sqrtl15 = sqrt(-2. + l2d + l2d*l2d);
  const double sqrtl16 = sqrt(1. + l1d);
  const double sqrtl17 = sqrt(l1d);
  const double sqrtl18 = 1.0/sqrtl16;
  const double sqrtl19 = sqrt(-2. - 1.*l1d + 2.*l1d*l1d + l1d*l1d*l1d);
  
  const double c1 = Coupling(l3,m3,0,l1,m1,0,l2,m2,0);
  const double c2 = Coupling(l3,m3,0,l1,m1,-3,l2,m2,3);
  const double c3 = Coupling(l3,m3,0,l1,m1,3,l2,m2,-3);
  const double c4 = Coupling(l3,m3,0,l1,m1,-1,l2,m2,1);
  const double c5 = Coupling(l3,m3,0,l1,m1,1,l2,m2,-1);
  const double c6 = Coupling(l3,m3,0,l1,m1,2,l2,m2,-2);
  const double c7 = Coupling(l3,m3,0,l1,m1,-2,l2,m2,2);

  if(l1==0&&l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];
      ricci[j] = (0.7071067811865475*c1*(2.*(-2. + r_2*fp[j])*h[1][0][0][j]*h[1][0][0][j] + 2.*f[j]*r[j]*(h[1][0][0][j]*h[1][0][0][j] - h[2][0][0][j]*h[2][0][0][j]) - 2.*f[j]*(-2. + r_2*fp[j])*h[1][0][0][j]*h[3][0][0][j] + f_2*(r_3*ddh[6][0][0][j]*h[1][0][0][j] - 2.*r[j]*(dh[6][0][0][j] + 2.*h[1][0][0][j])*h[3][0][0][j] + 2.*r_2*(dh[3][0][0][j]*h[1][0][0][j] + h[3][0][0][j]*(dh[1][0][0][j] + fp[j]*h[3][0][0][j])) - 6.*r[j]*h[1][0][0][j]*h[6][0][0][j] - 4.*h[3][0][0][j]*(2.*h[3][0][0][j] + h[6][0][0][j])) + f_3*r[j]*(r_2*(dh[6][0][0][j]*dh[6][0][0][j] - ddh[6][0][0][j]*h[3][0][0][j]) + 4.*r[j]*dh[6][0][0][j]*h[6][0][0][j] + 2.*(h[3][0][0][j] + h[6][0][0][j])*(h[3][0][0][j] + 2.*h[6][0][0][j]))))/(f_2*r_3);
    }
  } else if(l1==1&&l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*(-((dh[4][1][m1][j]*h[2][0][0][j])/(f[j]*r[j])) - (dh[5][1][m1][j]*h[3][0][0][j])/r[j] + ddh[6][1][m1][j]*(0.7071067811865475*h[1][0][0][j] - 0.7071067811865475*f[j]*h[3][0][0][j]) + h[2][1][m1][j]*((-1.4142135623730951*(-1 + f[j])*h[2][0][0][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/(f[j]*r[j])) + h[1][1][m1][j]*((-1.4142135623730951*I*m1d*Omega*h[2][0][0][j])/(f_2*r[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[3][0][0][j])/(r_3*f[j])) + (1.4142135623730951*(-4. + r_2*fp[j] + (-1 + f[j])*r[j])*h[3][0][0][j]*h[3][1][m1][j])/r_3 + (4.*h[5][1][m1][j]*h[6][0][0][j])/r_2 + dh[6][1][m1][j]*(0.7071067811865475*f[j]*dh[6][0][0][j] + (1.4142135623730951*I*m1d*Omega*h[2][0][0][j])/f[j] - (1.4142135623730951*h[3][0][0][j])/r_2 + (1.4142135623730951*f[j]*h[6][0][0][j])/r[j]) + (1.4142135623730951*(-1 + 2.*f[j])*h[6][0][0][j]*h[6][1][m1][j])/r_2 + h[2][0][0][j]*((1.4142135623730951*I*m1d*Omega*h[3][1][m1][j])/(f[j]*r[j]) + ((2. + f[j]*r[j])*h[4][1][m1][j])/(f_2*r_3) + (I*m1d*Omega*h[5][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*I*m1d*Omega*h[6][1][m1][j])/(f_2*r_2)) + h[1][0][0][j]*((1.4142135623730951*dh[3][1][m1][j])/r[j] + dh[5][1][m1][j]/(f[j]*r[j]) + (1.4142135623730951*(-2. + r_2*fp[j] + (-1 + f[j])*r[j])*h[1][1][m1][j])/(f_2*r_3) + (1.4142135623730951*I*m1d*Omega*h[2][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*h[3][1][m1][j])/r_2 - (I*m1d*Omega*h[4][1][m1][j])/(f_2*r[j]) - ((f[j] + fp[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) + 0.7071067811865475*(-6./r_2 - (m1d*m1d*Omega_2)/f_2)*h[6][1][m1][j]) + dh[6][0][0][j]*(h[5][1][m1][j]/r[j] + (1.4142135623730951*f[j]*h[6][1][m1][j])/r[j]) + h[3][0][0][j]*((1.4142135623730951*dh[1][1][m1][j])/r[j] - (I*m1d*Omega*h[4][1][m1][j])/(f[j]*r[j]) + ((-2. + r_2*fp[j] + f[j]*r[j])*h[5][1][m1][j])/(r_3*f[j]) + (0.7071067811865475*(-(m1d*m1d*r_3*Omega_2) - 4.*f[j] + 6.*f_2*r[j])*h[6][1][m1][j])/(r_3*f[j])));    
    }
  } else if(l1==0&&l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*((-1.4142135623730951*h[2][0][0][j]*h[2][1][m2][j])/(r_2*f[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[1][0][0][j]*h[3][1][m2][j])/(r_3*f[j]) + (1.4142135623730951*(-4. + r_2*fp[j] + f[j]*r[j])*h[3][0][0][j]*h[3][1][m2][j])/r_3 + ddh[6][0][0][j]*(0.7071067811865475*h[1][1][m2][j] - 0.7071067811865475*f[j]*h[3][1][m2][j]) + (1.4142135623730951*f[j]*dh[6][1][m2][j]*h[6][0][0][j])/r[j] + h[1][1][m2][j]*((1.4142135623730951*dh[3][0][0][j])/r[j] + (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[1][0][0][j])/(f_2*r_3) - (1.4142135623730951*h[3][0][0][j])/r_2 - (4.242640687119286*h[6][0][0][j])/r_2) + h[3][1][m2][j]*((1.4142135623730951*dh[1][0][0][j])/r[j] + (1.4142135623730951*(-2. + 3.*f[j]*r[j])*h[6][0][0][j])/r_3) + (2.8284271247461903*f[j]*h[6][0][0][j]*h[6][1][m2][j])/r_2 + dh[6][0][0][j]*(0.7071067811865475*f[j]*dh[6][1][m2][j] - (1.4142135623730951*h[3][1][m2][j])/r_2 + (1.4142135623730951*f[j]*h[6][1][m2][j])/r[j]));
    }
  } else if(l1==1&&l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*(-((dh[4][1][m1][j]*h[2][1][m2][j])/(f[j]*r[j])) - (dh[5][1][m1][j]*h[3][1][m2][j])/r[j] + (1.4142135623730951*(-4. + r_2*fp[j] + (-1 + f[j])*r[j])*h[3][1][m1][j]*h[3][1][m2][j])/r_3 + ddh[6][1][m1][j]*(0.7071067811865475*h[1][1][m2][j] - 0.7071067811865475*f[j]*h[3][1][m2][j]) + h[2][1][m1][j]*((-1.4142135623730951*(-1 + f[j])*h[2][1][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[3][1][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((-1.4142135623730951*I*m1d*Omega*h[2][1][m2][j])/(f_2*r[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[3][1][m2][j])/(r_3*f[j])) + h[2][1][m2][j]*((1.4142135623730951*I*m1d*Omega*h[3][1][m1][j])/(f[j]*r[j]) + ((2. + f[j]*r[j])*h[4][1][m1][j])/(f_2*r_3) + (I*m1d*Omega*h[5][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*I*m1d*Omega*h[6][1][m1][j])/(f_2*r_2)) + h[1][1][m2][j]*((1.4142135623730951*dh[3][1][m1][j])/r[j] + dh[5][1][m1][j]/(f[j]*r[j]) + (1.4142135623730951*(-2. + r_2*fp[j] + (-1 + f[j])*r[j])*h[1][1][m1][j])/(f_2*r_3) + (1.4142135623730951*I*m1d*Omega*h[2][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*h[3][1][m1][j])/r_2 - (I*m1d*Omega*h[4][1][m1][j])/(f_2*r[j]) - ((f[j] + fp[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) + 0.7071067811865475*(-6./r_2 - (m1d*m1d*Omega_2)/f_2)*h[6][1][m1][j]) + dh[6][1][m2][j]*(h[5][1][m1][j]/r[j] + (1.4142135623730951*f[j]*h[6][1][m1][j])/r[j]) + h[3][1][m2][j]*((1.4142135623730951*dh[1][1][m1][j])/r[j] - (I*m1d*Omega*h[4][1][m1][j])/(f[j]*r[j]) + ((-2. + r_2*fp[j] + f[j]*r[j])*h[5][1][m1][j])/(r_3*f[j]) + (0.7071067811865475*(-(m1d*m1d*r_3*Omega_2) - 4.*f[j] + 6.*f_2*r[j])*h[6][1][m1][j])/(r_3*f[j])) + (0.7071067811865475*(4.*f_2 + m1d*m2d*r_2*Omega_2 - 2.*f[j])*h[6][1][m1][j]*h[6][1][m2][j])/(r_2*f[j]) + h[5][1][m1][j]*((0.7071067811865475*h[5][1][m2][j])/(r_2*f[j]) + (4.*h[6][1][m2][j])/r_2) + h[4][1][m1][j]*((-0.7071067811865475*h[4][1][m2][j])/(r_2*f[j]) + (I*m2d*Omega*h[6][1][m2][j])/(f[j]*r[j])) + dh[6][1][m1][j]*(0.7071067811865475*f[j]*dh[6][1][m2][j] + (1.4142135623730951*I*m1d*Omega*h[2][1][m2][j])/f[j] - (1.4142135623730951*h[3][1][m2][j])/r_2 + (1.4142135623730951*f[j]*h[6][1][m2][j])/r[j]) - (0.7071067811865475*h[8][1][m1][j]*h[8][1][m2][j])/(r_2*f[j]) + (0.7071067811865475*h[9][1][m1][j]*h[9][1][m2][j])/(r_2*f[j])) + c3*((-0.35355339059327373*h[1][1][m1][j]*h[1][1][m2][j])/(f_2*r_2) + h[2][1][m1][j]*((0.35355339059327373*h[2][1][m2][j])/(f_2*r_2) - h[4][1][m2][j]/(r_2*f[j]) - (I*h[8][1][m2][j])/(r_2*f[j])) + h[6][1][m1][j]*((-0.7071067811865475*h[6][1][m2][j])/r_2 + (m1d*Omega*h[8][1][m2][j])/(2.*f[j]*r[j])) + (0.17677669529663687*I*m1d*Omega*h[8][1][m2][j]*h[9][1][m1][j])/(f[j]*r[j]) + dh[8][1][m2][j]*((0.17677669529663687*I*h[4][1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*h[8][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][1][m1][j])/f[j]) + dh[4][1][m2][j]*(-0.17677669529663687*I*dh[8][1][m1][j] + (0.17677669529663687*h[4][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/f[j] - (0.17677669529663687*I*h[8][1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/f[j]) + h[4][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/(f[j]*r[j]) - (0.5*I*m1d*Omega*h[6][1][m1][j])/(f[j]*r[j]) - (0.17677669529663687*I*(-4. + (-2. + f[j])*r[j])*h[8][1][m1][j])/(r_3*f[j]) + (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/(f[j]*r[j])) + h[5][1][m2][j]*((0.17677669529663687*m2d*Omega*h[8][1][m1][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + r[j]))*h[9][1][m1][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + r[j]))*h[9][1][m1][j]*h[9][1][m2][j])/(f_2*r_3) + h[3][1][m1][j]*((-0.35355339059327373*h[3][1][m2][j])/r_2 - h[5][1][m2][j]/r_2 - (I*h[9][1][m2][j])/r_2) + h[1][1][m1][j]*(h[5][1][m2][j]/(r_2*f[j]) + (I*h[9][1][m2][j])/(r_2*f[j])) + dh[4][1][m1][j]*(0.17677669529663687*dh[4][1][m2][j] + 0.17677669529663687*I*dh[8][1][m2][j] + (0.17677669529663687*h[4][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*I*h[8][1][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[8][1][m1][j]*(0.17677669529663687*dh[8][1][m2][j] - (0.17677669529663687*I*h[4][1][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*h[8][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[6][1][m1][j]*(-h[5][1][m2][j]/(2.*r[j]) - (0.5*I*h[9][1][m2][j])/r[j]) + h[4][1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) - (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[8][1][m1][j]*((0.17677669529663687*(-4. + (-2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[5][1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][1][m2][j])/(f_2*r_3) - (0.17677669529663687*m1d*Omega*h[8][1][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][1][m2][j])/(f_2*r_3))) + c2*((-0.35355339059327373*h[1][1][m1][j]*h[1][1][m2][j])/(f_2*r_2) + h[2][1][m1][j]*((0.35355339059327373*h[2][1][m2][j])/(f_2*r_2) - h[4][1][m2][j]/(r_2*f[j]) + (I*h[8][1][m2][j])/(r_2*f[j])) + h[6][1][m1][j]*((-0.7071067811865475*h[6][1][m2][j])/r_2 - (m1d*Omega*h[8][1][m2][j])/(2.*f[j]*r[j])) + (0.17677669529663687*I*m1d*Omega*h[8][1][m2][j]*h[9][1][m1][j])/(f[j]*r[j]) + dh[4][1][m2][j]*(0.17677669529663687*I*dh[8][1][m1][j] + (0.17677669529663687*h[4][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*I*h[8][1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/f[j]) + dh[8][1][m2][j]*((-0.17677669529663687*I*h[4][1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*h[8][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][1][m1][j])/f[j]) + h[4][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/(f[j]*r[j]) - (0.5*I*m1d*Omega*h[6][1][m1][j])/(f[j]*r[j]) + (0.17677669529663687*I*(-4. + (-2. + f[j])*r[j])*h[8][1][m1][j])/(r_3*f[j]) - (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/(f[j]*r[j])) + h[5][1][m2][j]*((-0.17677669529663687*m2d*Omega*h[8][1][m1][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + r[j]))*h[9][1][m1][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + r[j]))*h[9][1][m1][j]*h[9][1][m2][j])/(f_2*r_3) + h[3][1][m1][j]*((-0.35355339059327373*h[3][1][m2][j])/r_2 - h[5][1][m2][j]/r_2 + (I*h[9][1][m2][j])/r_2) + h[1][1][m1][j]*(h[5][1][m2][j]/(r_2*f[j]) - (I*h[9][1][m2][j])/(r_2*f[j])) + dh[8][1][m1][j]*(0.17677669529663687*dh[8][1][m2][j] + (0.17677669529663687*I*h[4][1][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*h[8][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[4][1][m1][j]*(0.17677669529663687*dh[4][1][m2][j] - 0.17677669529663687*I*dh[8][1][m2][j] + (0.17677669529663687*h[4][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/f[j] - (0.17677669529663687*I*h[8][1][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[6][1][m1][j]*(-h[5][1][m2][j]/(2.*r[j]) + (0.5*I*h[9][1][m2][j])/r[j]) + h[8][1][m1][j]*((0.17677669529663687*(-4. + (-2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[4][1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[5][1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][1][m2][j])/(f_2*r_3) + (0.17677669529663687*m1d*Omega*h[8][1][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][1][m2][j])/(f_2*r_3)));
    }
  } else if(l1==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*((-1.4142135623730951*h[2][0][0][j]*h[2][l2][m2][j])/(r_2*f[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[1][0][0][j]*h[3][l2][m2][j])/(r_3*f[j]) + (1.4142135623730951*(-4. + r_2*fp[j] + f[j]*r[j])*h[3][0][0][j]*h[3][l2][m2][j])/r_3 + ddh[6][0][0][j]*(0.7071067811865475*h[1][l2][m2][j] - 0.7071067811865475*f[j]*h[3][l2][m2][j]) + (1.4142135623730951*f[j]*dh[6][l2][m2][j]*h[6][0][0][j])/r[j] + h[1][l2][m2][j]*((1.4142135623730951*dh[3][0][0][j])/r[j] + (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[1][0][0][j])/(f_2*r_3) - (1.4142135623730951*h[3][0][0][j])/r_2 - (4.242640687119286*h[6][0][0][j])/r_2) + h[3][l2][m2][j]*((1.4142135623730951*dh[1][0][0][j])/r[j] + (1.4142135623730951*(-2. + 3.*f[j]*r[j])*h[6][0][0][j])/r_3) + (2.8284271247461903*f[j]*h[6][0][0][j]*h[6][l2][m2][j])/r_2 + dh[6][0][0][j]*(0.7071067811865475*f[j]*dh[6][l2][m2][j] - (1.4142135623730951*h[3][l2][m2][j])/r_2 + (1.4142135623730951*f[j]*h[6][l2][m2][j])/r[j]));
    }
  } else if(l2==0) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*((-0.7071067811865475*sqrtl4*sqrtl5*dh[4][l1][m1][j]*h[2][0][0][j])/(f[j]*r[j]) - (0.7071067811865475*sqrtl4*sqrtl5*dh[5][l1][m1][j]*h[3][0][0][j])/r[j] + ddh[6][l1][m1][j]*(0.7071067811865475*h[1][0][0][j] - 0.7071067811865475*f[j]*h[3][0][0][j]) + h[2][l1][m1][j]*((0.7071067811865475*(l1d + l1d*l1d - 2.*f[j])*h[2][0][0][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[3][0][0][j])/(f[j]*r[j])) + h[1][l1][m1][j]*((-1.4142135623730951*I*m1d*Omega*h[2][0][0][j])/(f_2*r[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[3][0][0][j])/(r_3*f[j])) + (0.7071067811865475*(-8. + 2.*r_2*fp[j] - l1d*r[j] - l1d*l1d*r[j] + 2.*f[j]*r[j])*h[3][0][0][j]*h[3][l1][m1][j])/r_3 + (1.4142135623730951*sqrtl15*(2.*sqrtl5 + 2*l1d*sqrtl5)*h[5][l1][m1][j]*h[6][0][0][j])/r_2 + dh[6][l1][m1][j]*(0.7071067811865475*f[j]*dh[6][0][0][j] + (1.4142135623730951*I*m1d*Omega*h[2][0][0][j])/f[j] - (1.4142135623730951*h[3][0][0][j])/r_2 + (1.4142135623730951*f[j]*h[6][0][0][j])/r[j]) + (0.7071067811865475*(-(sqrtl1*sqrtl4*sqrtl5) + 4.*f[j])*h[6][0][0][j]*h[6][l1][m1][j])/r_2 + h[2][0][0][j]*((1.4142135623730951*I*m1d*Omega*h[3][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*sqrtl15*(2.*l1d*sqrtl5*f[j]*r[j] + l1d*sqrtl5*(2. - f[j]*r[j]) + sqrtl5*(2. + f[j]*r[j]))*h[4][l1][m1][j])/(f_2*r_3) + (0.7071067811865475*I*m1d*sqrtl4*sqrtl5*Omega*h[5][l1][m1][j])/(f_2*r[j]) - (1.4142135623730951*I*m1d*Omega*h[6][l1][m1][j])/(f_2*r_2)) + h[1][0][0][j]*((1.4142135623730951*dh[3][l1][m1][j])/r[j] + (0.7071067811865475*sqrtl4*sqrtl5*dh[5][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*(-4. + 2.*r_2*fp[j] - l1d*r[j] - l1d*l1d*r[j] + 2.*f[j]*r[j])*h[1][l1][m1][j])/(f_2*r_3) + (1.4142135623730951*I*m1d*Omega*h[2][l1][m1][j])/(f_2*r[j]) - (1.4142135623730951*h[3][l1][m1][j])/r_2 - (0.7071067811865475*I*m1d*sqrtl4*sqrtl5*Omega*h[4][l1][m1][j])/(f_2*r[j]) + (0.7071067811865475*sqrtl15*((-sqrtl5 - 1.*l1d*sqrtl5)*f[j] - (1 + l1d)*sqrtl5*fp[j]*r[j])*h[5][l1][m1][j])/(f_2*r_2) + 0.7071067811865475*(-6./r_2 - (m1d*m1d*Omega_2)/f_2)*h[6][l1][m1][j]) + dh[6][0][0][j]*((0.7071067811865475*sqrtl15*(sqrtl5 + l1d*sqrtl5)*h[5][l1][m1][j])/r[j] + (1.4142135623730951*f[j]*h[6][l1][m1][j])/r[j]) + h[3][0][0][j]*((1.4142135623730951*dh[1][l1][m1][j])/r[j] - (0.7071067811865475*I*m1d*sqrtl4*sqrtl5*Omega*h[4][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*sqrtl15*(2.*l1d*sqrtl5*f[j]*r[j] + l1d*sqrtl5*(-2. + r_2*fp[j] - f[j]*r[j]) + sqrtl5*(-2. + r_2*fp[j] + f[j]*r[j]))*h[5][l1][m1][j])/(r_3*f[j]) + (0.7071067811865475*(-(m1d*m1d*r_3*Omega_2) - 4.*f[j] + 6.*f_2*r[j])*h[6][l1][m1][j])/(r_3*f[j])));
    }
  } else if(l1==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*(-((dh[4][1][m1][j]*h[2][l2][m2][j])/(f[j]*r[j])) - (dh[5][1][m1][j]*h[3][l2][m2][j])/r[j] + (1.4142135623730951*(-4. + r_2*fp[j] + (-1 + f[j])*r[j])*h[3][1][m1][j]*h[3][l2][m2][j])/r_3 + ddh[6][1][m1][j]*(0.7071067811865475*h[1][l2][m2][j] - 0.7071067811865475*f[j]*h[3][l2][m2][j]) + h[2][1][m1][j]*((-1.4142135623730951*(-1 + f[j])*h[2][l2][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[3][l2][m2][j])/(f[j]*r[j])) + h[1][1][m1][j]*((-1.4142135623730951*I*m1d*Omega*h[2][l2][m2][j])/(f_2*r[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[3][l2][m2][j])/(r_3*f[j])) + h[2][l2][m2][j]*((1.4142135623730951*I*m1d*Omega*h[3][1][m1][j])/(f[j]*r[j]) + ((2. + f[j]*r[j])*h[4][1][m1][j])/(f_2*r_3) + (I*m1d*Omega*h[5][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*I*m1d*Omega*h[6][1][m1][j])/(f_2*r_2)) + h[1][l2][m2][j]*((1.4142135623730951*dh[3][1][m1][j])/r[j] + dh[5][1][m1][j]/(f[j]*r[j]) + (1.4142135623730951*(-2. + r_2*fp[j] + (-1 + f[j])*r[j])*h[1][1][m1][j])/(f_2*r_3) + (1.4142135623730951*I*m1d*Omega*h[2][1][m1][j])/(f_2*r[j]) - (1.4142135623730951*h[3][1][m1][j])/r_2 - (I*m1d*Omega*h[4][1][m1][j])/(f_2*r[j]) - ((f[j] + fp[j]*r[j])*h[5][1][m1][j])/(f_2*r_2) + 0.7071067811865475*(-6./r_2 - (m1d*m1d*Omega_2)/f_2)*h[6][1][m1][j]) + dh[6][l2][m2][j]*(h[5][1][m1][j]/r[j] + (1.4142135623730951*f[j]*h[6][1][m1][j])/r[j]) + h[3][l2][m2][j]*((1.4142135623730951*dh[1][1][m1][j])/r[j] - (I*m1d*Omega*h[4][1][m1][j])/(f[j]*r[j]) + ((-2. + r_2*fp[j] + f[j]*r[j])*h[5][1][m1][j])/(r_3*f[j]) + (0.7071067811865475*(-(m1d*m1d*r_3*Omega_2) - 4.*f[j] + 6.*f_2*r[j])*h[6][1][m1][j])/(r_3*f[j])) + (0.7071067811865475*(4.*f_2 + m1d*m2d*r_2*Omega_2 - 2.*f[j])*h[6][1][m1][j]*h[6][l2][m2][j])/(r_2*f[j]) + h[5][1][m1][j]*((sqrtl1*sqrtl8*(2.*sqrtl8 + 2*l2d*sqrtl8)*h[5][l2][m2][j])/(4.*r_2*sqrtl2*f[j]) + (4.*h[6][l2][m2][j])/r_2) + h[4][1][m1][j]*((sqrtl1*sqrtl8*(-2.*sqrtl8 - 2*l2d*sqrtl8)*h[4][l2][m2][j])/(4.*r_2*sqrtl2*f[j]) + (I*m2d*Omega*h[6][l2][m2][j])/(f[j]*r[j])) + dh[6][1][m1][j]*(0.7071067811865475*f[j]*dh[6][l2][m2][j] + (1.4142135623730951*I*m1d*Omega*h[2][l2][m2][j])/f[j] - (1.4142135623730951*h[3][l2][m2][j])/r_2 + (1.4142135623730951*f[j]*h[6][l2][m2][j])/r[j]) + (sqrtl1*sqrtl8*(-2.*sqrtl8 - 2*l2d*sqrtl8)*h[8][1][m1][j]*h[8][l2][m2][j])/(4.*r_2*sqrtl2*f[j]) + (sqrtl1*sqrtl8*(2.*sqrtl8 + 2*l2d*sqrtl8)*h[9][1][m1][j]*h[9][l2][m2][j])/(4.*r_2*sqrtl2*f[j])) + c3*(-(sqrtl2*h[1][1][m1][j]*h[1][l2][m2][j])/(4.*f_2*r_2*sqrtl1) + h[2][1][m1][j]*((sqrtl2*h[2][l2][m2][j])/(4.*f_2*r_2*sqrtl1) - h[4][l2][m2][j]/(r_2*f[j]) - (I*h[8][l2][m2][j])/(r_2*f[j])) + (0.17677669529663687*I*m1d*Omega*h[8][l2][m2][j]*h[9][1][m1][j])/(f[j]*r[j]) + dh[8][l2][m2][j]*((0.17677669529663687*I*h[4][1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*h[8][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][1][m1][j])/f[j]) + dh[4][l2][m2][j]*(-0.17677669529663687*I*dh[8][1][m1][j] + (0.17677669529663687*h[4][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/f[j] - (0.17677669529663687*I*h[8][1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/f[j]) + h[4][l2][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/(f[j]*r[j]) - (0.5*I*m1d*Omega*h[6][1][m1][j])/(f[j]*r[j]) - (0.17677669529663687*I*(-4. + (-2. + f[j])*r[j])*h[8][1][m1][j])/(r_3*f[j]) + (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/(f[j]*r[j])) + h[5][l2][m2][j]*((0.17677669529663687*m2d*Omega*h[8][1][m1][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + r[j]))*h[9][1][m1][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + r[j]))*h[9][1][m1][j]*h[9][l2][m2][j])/(f_2*r_3) + h[3][1][m1][j]*(-(sqrtl2*h[3][l2][m2][j])/(4.*r_2*sqrtl1) - h[5][l2][m2][j]/r_2 - (I*h[9][l2][m2][j])/r_2) + h[1][1][m1][j]*(h[5][l2][m2][j]/(r_2*f[j]) + (I*h[9][l2][m2][j])/(r_2*f[j])) + dh[4][1][m1][j]*(0.17677669529663687*dh[4][l2][m2][j] + 0.17677669529663687*I*dh[8][l2][m2][j] + (0.17677669529663687*h[4][l2][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][l2][m2][j])/f[j] + (0.17677669529663687*I*h[8][l2][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[9][l2][m2][j])/f[j]) + dh[8][1][m1][j]*(0.17677669529663687*dh[8][l2][m2][j] - (0.17677669529663687*I*h[4][l2][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[5][l2][m2][j])/f[j] + (0.17677669529663687*h[8][l2][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][l2][m2][j])/f[j]) + dh[6][1][m1][j]*(-h[5][l2][m2][j]/(2.*r[j]) - (0.5*I*h[9][l2][m2][j])/r[j]) + h[4][1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][l2][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][l2][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][l2][m2][j])/(r_3*f[j]) - (0.17677669529663687*m2d*Omega*h[9][l2][m2][j])/(f[j]*r[j])) + h[8][1][m1][j]*((0.17677669529663687*(-4. + (-2. + f[j])*r[j])*h[8][l2][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][l2][m2][j])/(f[j]*r[j])) + h[5][1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][l2][m2][j])/(f_2*r_3) - (0.17677669529663687*m1d*Omega*h[8][l2][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][l2][m2][j])/(f_2*r_3)) + h[6][1][m1][j]*(-(sqrtl2*h[6][l2][m2][j])/(2.*r_2*sqrtl1) - (sqrtl10*h[7][l2][m2][j])/(4.*r_2*sqrtl1) + (m1d*Omega*h[8][l2][m2][j])/(2.*f[j]*r[j]) - (0.25*I*sqrtl10*h[10][l2][m2][j])/(r_2*sqrtl1))) + c2*(-(sqrtl2*h[1][1][m1][j]*h[1][l2][m2][j])/(4.*f_2*r_2*sqrtl1) + h[2][1][m1][j]*((sqrtl2*h[2][l2][m2][j])/(4.*f_2*r_2*sqrtl1) - h[4][l2][m2][j]/(r_2*f[j]) + (I*h[8][l2][m2][j])/(r_2*f[j])) + (0.17677669529663687*I*m1d*Omega*h[8][l2][m2][j]*h[9][1][m1][j])/(f[j]*r[j]) + dh[4][l2][m2][j]*(0.17677669529663687*I*dh[8][1][m1][j] + (0.17677669529663687*h[4][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*I*h[8][1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/f[j]) + dh[8][l2][m2][j]*((-0.17677669529663687*I*h[4][1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[5][1][m1][j])/f[j] + (0.17677669529663687*h[8][1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][1][m1][j])/f[j]) + h[4][l2][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][1][m1][j])/(f[j]*r[j]) - (0.5*I*m1d*Omega*h[6][1][m1][j])/(f[j]*r[j]) + (0.17677669529663687*I*(-4. + (-2. + f[j])*r[j])*h[8][1][m1][j])/(r_3*f[j]) - (0.17677669529663687*m1d*Omega*h[9][1][m1][j])/(f[j]*r[j])) + h[5][l2][m2][j]*((-0.17677669529663687*m2d*Omega*h[8][1][m1][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + r[j]))*h[9][1][m1][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + r[j]))*h[9][1][m1][j]*h[9][l2][m2][j])/(f_2*r_3) + h[3][1][m1][j]*(-(sqrtl2*h[3][l2][m2][j])/(4.*r_2*sqrtl1) - h[5][l2][m2][j]/r_2 + (I*h[9][l2][m2][j])/r_2) + h[1][1][m1][j]*(h[5][l2][m2][j]/(r_2*f[j]) - (I*h[9][l2][m2][j])/(r_2*f[j])) + dh[8][1][m1][j]*(0.17677669529663687*dh[8][l2][m2][j] + (0.17677669529663687*I*h[4][l2][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[5][l2][m2][j])/f[j] + (0.17677669529663687*h[8][l2][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][l2][m2][j])/f[j]) + dh[4][1][m1][j]*(0.17677669529663687*dh[4][l2][m2][j] - 0.17677669529663687*I*dh[8][l2][m2][j] + (0.17677669529663687*h[4][l2][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][l2][m2][j])/f[j] - (0.17677669529663687*I*h[8][l2][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[9][l2][m2][j])/f[j]) + dh[6][1][m1][j]*(-h[5][l2][m2][j]/(2.*r[j]) + (0.5*I*h[9][l2][m2][j])/r[j]) + h[8][1][m1][j]*((0.17677669529663687*(-4. + (-2. + f[j])*r[j])*h[8][l2][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][l2][m2][j])/(f[j]*r[j])) + h[4][1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][l2][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][l2][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][l2][m2][j])/(r_3*f[j]) + (0.17677669529663687*m2d*Omega*h[9][l2][m2][j])/(f[j]*r[j])) + h[5][1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][l2][m2][j])/(f_2*r_3) + (0.17677669529663687*m1d*Omega*h[8][l2][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][l2][m2][j])/(f_2*r_3)) + h[6][1][m1][j]*(-(sqrtl2*h[6][l2][m2][j])/(2.*r_2*sqrtl1) - (sqrtl10*h[7][l2][m2][j])/(4.*r_2*sqrtl1) - (m1d*Omega*h[8][l2][m2][j])/(2.*f[j]*r[j]) + (0.25*I*sqrtl10*h[10][l2][m2][j])/(r_2*sqrtl1)));
    }
  } else if(l2==1) {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      ricci[j] = c1*((-0.7071067811865475*sqrtl11*sqrtl5*dh[4][l1][m1][j]*h[2][1][m2][j])/(f[j]*r[j]) - (0.7071067811865475*sqrtl11*sqrtl5*dh[5][l1][m1][j]*h[3][1][m2][j])/r[j] + ddh[6][l1][m1][j]*(0.7071067811865475*h[1][1][m2][j] - 0.7071067811865475*f[j]*h[3][1][m2][j]) + h[2][l1][m1][j]*((0.7071067811865475*(l1d + l1d*l1d - 2.*f[j])*h[2][1][m2][j])/(f_2*r_2) + (1.4142135623730951*I*m1d*Omega*h[3][1][m2][j])/(f[j]*r[j])) + h[1][l1][m1][j]*((-1.4142135623730951*I*m1d*Omega*h[2][1][m2][j])/(f_2*r[j]) - (1.4142135623730951*(-2. + r_2*fp[j] + f[j]*r[j])*h[3][1][m2][j])/(r_3*f[j])) + (0.7071067811865475*(-8. + 2.*r_2*fp[j] - l1d*r[j] - l1d*l1d*r[j] + 2.*f[j]*r[j])*h[3][1][m2][j]*h[3][l1][m1][j])/r_3 + h[5][l1][m1][j]*((sqrtl15*(2.*sqrtl5 + 2*l1d*sqrtl5)*h[5][1][m2][j])/(4.*r_2*f[j]) + (1.4142135623730951*sqrtl15*(2.*sqrtl5 + 2*l1d*sqrtl5)*h[6][1][m2][j])/r_2) + h[4][l1][m1][j]*((sqrtl15*(-2.*sqrtl5 - 2*l1d*sqrtl5)*h[4][1][m2][j])/(4.*r_2*f[j]) + (0.7071067811865475*I*m2d*sqrtl15*(sqrtl5 + l1d*sqrtl5)*Omega*h[6][1][m2][j])/(f[j]*r[j])) + dh[6][l1][m1][j]*(0.7071067811865475*f[j]*dh[6][1][m2][j] + (1.4142135623730951*I*m1d*Omega*h[2][1][m2][j])/f[j] - (1.4142135623730951*h[3][1][m2][j])/r_2 + (1.4142135623730951*f[j]*h[6][1][m2][j])/r[j]) + (0.7071067811865475*(4.*f_2 + m1d*m2d*r_2*Omega_2 - sqrtl1*sqrtl11*sqrtl5*f[j])*h[6][1][m2][j]*h[6][l1][m1][j])/(r_2*f[j]) + h[2][1][m2][j]*((1.4142135623730951*I*m1d*Omega*h[3][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*sqrtl15*(2.*l1d*sqrtl5*f[j]*r[j] + l1d*sqrtl5*(2. - f[j]*r[j]) + sqrtl5*(2. + f[j]*r[j]))*h[4][l1][m1][j])/(f_2*r_3) + (0.7071067811865475*I*m1d*sqrtl11*sqrtl5*Omega*h[5][l1][m1][j])/(f_2*r[j]) - (1.4142135623730951*I*m1d*Omega*h[6][l1][m1][j])/(f_2*r_2)) + h[1][1][m2][j]*((1.4142135623730951*dh[3][l1][m1][j])/r[j] + (0.7071067811865475*sqrtl11*sqrtl5*dh[5][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*(-4. + 2.*r_2*fp[j] - l1d*r[j] - l1d*l1d*r[j] + 2.*f[j]*r[j])*h[1][l1][m1][j])/(f_2*r_3) + (1.4142135623730951*I*m1d*Omega*h[2][l1][m1][j])/(f_2*r[j]) - (1.4142135623730951*h[3][l1][m1][j])/r_2 - (0.7071067811865475*I*m1d*sqrtl11*sqrtl5*Omega*h[4][l1][m1][j])/(f_2*r[j]) + (0.7071067811865475*sqrtl15*((-sqrtl5 - 1.*l1d*sqrtl5)*f[j] - (1 + l1d)*sqrtl5*fp[j]*r[j])*h[5][l1][m1][j])/(f_2*r_2) + 0.7071067811865475*(-6./r_2 - (m1d*m1d*Omega_2)/f_2)*h[6][l1][m1][j]) + dh[6][1][m2][j]*((0.7071067811865475*sqrtl15*(sqrtl5 + l1d*sqrtl5)*h[5][l1][m1][j])/r[j] + (1.4142135623730951*f[j]*h[6][l1][m1][j])/r[j]) + h[3][1][m2][j]*((1.4142135623730951*dh[1][l1][m1][j])/r[j] - (0.7071067811865475*I*m1d*sqrtl11*sqrtl5*Omega*h[4][l1][m1][j])/(f[j]*r[j]) + (0.7071067811865475*sqrtl15*(2.*l1d*sqrtl5*f[j]*r[j] + l1d*sqrtl5*(-2. + r_2*fp[j] - f[j]*r[j]) + sqrtl5*(-2. + r_2*fp[j] + f[j]*r[j]))*h[5][l1][m1][j])/(r_3*f[j]) + (0.7071067811865475*(-(m1d*m1d*r_3*Omega_2) - 4.*f[j] + 6.*f_2*r[j])*h[6][l1][m1][j])/(r_3*f[j])) + (sqrtl15*(-2.*sqrtl5 - 2*l1d*sqrtl5)*h[8][1][m2][j]*h[8][l1][m1][j])/(4.*r_2*f[j]) + (sqrtl15*(2.*sqrtl5 + 2*l1d*sqrtl5)*h[9][1][m2][j]*h[9][l1][m1][j])/(4.*r_2*f[j])) + c3*(-(sqrtl1*h[1][1][m2][j]*h[1][l1][m1][j])/(4.*f_2*r_2) + h[2][l1][m1][j]*((sqrtl1*h[2][1][m2][j])/(4.*f_2*r_2) - (0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[4][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[8][1][m2][j])/(r_2*f[j])) + h[6][l1][m1][j]*(-(sqrtl1*h[6][1][m2][j])/(2.*r_2) + (0.35355339059327373*m1d*sqrtl11*sqrtl5*Omega*h[8][1][m2][j])/(f[j]*r[j])) - (0.35355339059327373*I*sqrtl15*sqrtl6*dh[7][l1][m1][j]*h[9][1][m2][j])/(sqrtl5*r[j]) - (0.35355339059327373*sqrtl15*sqrtl6*dh[10][l1][m1][j]*h[9][1][m2][j])/(sqrtl5*r[j]) + h[7][l1][m1][j]*((0.35355339059327373*m1d*sqrtl15*sqrtl6*Omega*h[8][1][m2][j])/(sqrtl5*f[j]*r[j]) + (0.7071067811865475*I*sqrtl3*h[9][1][m2][j])/r_2) + h[3][l1][m1][j]*(-(sqrtl1*h[3][1][m2][j])/(4.*r_2) - (0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[5][1][m2][j])/r_2 - (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[9][1][m2][j])/r_2) + h[1][l1][m1][j]*((0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[5][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[9][1][m2][j])/(r_2*f[j])) + dh[4][l1][m1][j]*(0.17677669529663687*dh[4][1][m2][j] + 0.17677669529663687*I*dh[8][1][m2][j] + (0.17677669529663687*h[4][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*I*h[8][1][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[8][l1][m1][j]*(0.17677669529663687*dh[8][1][m2][j] - (0.17677669529663687*I*h[4][1][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*h[8][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[6][l1][m1][j]*((-0.35355339059327373*sqrtl11*sqrtl5*h[5][1][m2][j])/r[j] - (0.35355339059327373*I*sqrtl11*sqrtl5*h[9][1][m2][j])/r[j]) + h[4][l1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) - (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[8][l1][m1][j]*((0.17677669529663687*(-4. + (-2.*(-1 + l1d + l1d*l1d) + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[5][l1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][1][m2][j])/(f_2*r_3) - (0.17677669529663687*m1d*Omega*h[8][1][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][1][m2][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + (-1 + l1d + l1d*l1d)*r[j]))*h[9][1][m2][j]*h[9][l1][m1][j])/(f_2*r_3) + dh[8][1][m2][j]*((0.17677669529663687*I*h[4][l1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[5][l1][m1][j])/f[j] + (0.17677669529663687*h[8][l1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][l1][m1][j])/f[j]) + dh[4][1][m2][j]*(-0.17677669529663687*I*dh[8][l1][m1][j] + (0.17677669529663687*h[4][l1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][l1][m1][j])/f[j] - (0.17677669529663687*I*h[8][l1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[9][l1][m1][j])/f[j]) + (0.7071067811865475*sqrtl3*h[9][1][m2][j]*h[10][l1][m1][j])/r_2 + h[6][1][m2][j]*(-(sqrtl3*h[7][l1][m1][j])/(4.*r_2) + (0.25*I*sqrtl3*h[10][l1][m1][j])/r_2) + h[5][1][m2][j]*((-0.35355339059327373*sqrtl15*sqrtl6*dh[7][l1][m1][j])/(sqrtl5*r[j]) + (0.35355339059327373*I*sqrtl15*sqrtl6*dh[10][l1][m1][j])/(sqrtl5*r[j]) + (0.7071067811865475*sqrtl3*h[7][l1][m1][j])/r_2 + (0.17677669529663687*m2d*Omega*h[8][l1][m1][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + (-1 + l1d + l1d*l1d)*r[j]))*h[9][l1][m1][j])/(f_2*r_3) - (0.7071067811865475*I*sqrtl3*h[10][l1][m1][j])/r_2) + h[4][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl11*sqrtl5*Omega*h[6][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl15*sqrtl6*Omega*h[7][l1][m1][j])/(sqrtl5*f[j]*r[j]) - (0.17677669529663687*I*(-4. + (-2.*(-1 + l1d + l1d*l1d) + f[j])*r[j])*h[8][l1][m1][j])/(r_3*f[j]) + (0.17677669529663687*m1d*Omega*h[9][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*m1d*sqrtl15*sqrtl6*Omega*h[10][l1][m1][j])/(sqrtl5*f[j]*r[j])) + h[8][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[9][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl15*sqrtl6*Omega*h[10][l1][m1][j])/(sqrtl5*f[j]*r[j]))) + c2*(-(sqrtl1*h[1][1][m2][j]*h[1][l1][m1][j])/(4.*f_2*r_2) + h[2][l1][m1][j]*((sqrtl1*h[2][1][m2][j])/(4.*f_2*r_2) - (0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[4][1][m2][j])/(r_2*f[j]) + (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[8][1][m2][j])/(r_2*f[j])) + h[6][l1][m1][j]*(-(sqrtl1*h[6][1][m2][j])/(2.*r_2) - (0.35355339059327373*m1d*sqrtl11*sqrtl5*Omega*h[8][1][m2][j])/(f[j]*r[j])) + (0.35355339059327373*I*sqrtl15*sqrtl6*dh[7][l1][m1][j]*h[9][1][m2][j])/(sqrtl5*r[j]) - (0.35355339059327373*sqrtl15*sqrtl6*dh[10][l1][m1][j]*h[9][1][m2][j])/(sqrtl5*r[j]) + h[7][l1][m1][j]*((-0.35355339059327373*m1d*sqrtl15*sqrtl6*Omega*h[8][1][m2][j])/(sqrtl5*f[j]*r[j]) - (0.7071067811865475*I*sqrtl3*h[9][1][m2][j])/r_2) + h[3][l1][m1][j]*(-(sqrtl1*h[3][1][m2][j])/(4.*r_2) - (0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[5][1][m2][j])/r_2 + (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[9][1][m2][j])/r_2) + h[1][l1][m1][j]*((0.35355339059327373*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[5][1][m2][j])/(r_2*f[j]) - (0.35355339059327373*I*sqrtl15*(sqrtl1*sqrtl11 + sqrtl5 + l1d*sqrtl5)*h[9][1][m2][j])/(r_2*f[j])) + dh[8][l1][m1][j]*(0.17677669529663687*dh[8][1][m2][j] + (0.17677669529663687*I*h[4][1][m2][j])/r[j] - (0.17677669529663687*m2d*Omega*h[5][1][m2][j])/f[j] + (0.17677669529663687*h[8][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[4][l1][m1][j]*(0.17677669529663687*dh[4][1][m2][j] - 0.17677669529663687*I*dh[8][1][m2][j] + (0.17677669529663687*h[4][1][m2][j])/r[j] + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/f[j] - (0.17677669529663687*I*h[8][1][m2][j])/r[j] + (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/f[j]) + dh[6][l1][m1][j]*((-0.35355339059327373*sqrtl11*sqrtl5*h[5][1][m2][j])/r[j] + (0.35355339059327373*I*sqrtl11*sqrtl5*h[9][1][m2][j])/r[j]) + h[8][l1][m1][j]*((0.17677669529663687*(-4. + (-2.*(-1 + l1d + l1d*l1d) + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[4][l1][m1][j]*((0.17677669529663687*(-4. + (2. + f[j])*r[j])*h[4][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*I*m2d*Omega*h[5][1][m2][j])/(f[j]*r[j]) - (0.17677669529663687*I*(-4. + (2. + f[j])*r[j])*h[8][1][m2][j])/(r_3*f[j]) + (0.17677669529663687*m2d*Omega*h[9][1][m2][j])/(f[j]*r[j])) + h[5][l1][m1][j]*((-0.17677669529663687*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[5][1][m2][j])/(f_2*r_3) + (0.17677669529663687*m1d*Omega*h[8][1][m2][j])/(f[j]*r[j]) + (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 2.*f[j]*(-2. + r[j]) + 8.*f_2*r[j])*h[9][1][m2][j])/(f_2*r_3)) + (0.17677669529663687*(-(m1d*m2d*r_3*Omega_2) - 8.*f_2*r[j] + 2.*f[j]*(2. + (-1 + l1d + l1d*l1d)*r[j]))*h[9][1][m2][j]*h[9][l1][m1][j])/(f_2*r_3) + dh[4][1][m2][j]*(0.17677669529663687*I*dh[8][l1][m1][j] + (0.17677669529663687*h[4][l1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[5][l1][m1][j])/f[j] + (0.17677669529663687*I*h[8][l1][m1][j])/r[j] - (0.17677669529663687*m1d*Omega*h[9][l1][m1][j])/f[j]) + dh[8][1][m2][j]*((-0.17677669529663687*I*h[4][l1][m1][j])/r[j] + (0.17677669529663687*m1d*Omega*h[5][l1][m1][j])/f[j] + (0.17677669529663687*h[8][l1][m1][j])/r[j] + (0.17677669529663687*I*m1d*Omega*h[9][l1][m1][j])/f[j]) + (0.7071067811865475*sqrtl3*h[9][1][m2][j]*h[10][l1][m1][j])/r_2 + h[6][1][m2][j]*(-(sqrtl3*h[7][l1][m1][j])/(4.*r_2) - (0.25*I*sqrtl3*h[10][l1][m1][j])/r_2) + h[5][1][m2][j]*((-0.35355339059327373*sqrtl15*sqrtl6*dh[7][l1][m1][j])/(sqrtl5*r[j]) - (0.35355339059327373*I*sqrtl15*sqrtl6*dh[10][l1][m1][j])/(sqrtl5*r[j]) + (0.7071067811865475*sqrtl3*h[7][l1][m1][j])/r_2 - (0.17677669529663687*m2d*Omega*h[8][l1][m1][j])/(f[j]*r[j]) - (0.17677669529663687*I*(m1d*m2d*r_3*Omega_2 + 8.*f_2*r[j] - 2.*f[j]*(2. + (-1 + l1d + l1d*l1d)*r[j]))*h[9][l1][m1][j])/(f_2*r_3) + (0.7071067811865475*I*sqrtl3*h[10][l1][m1][j])/r_2) + h[8][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[9][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl15*sqrtl6*Omega*h[10][l1][m1][j])/(sqrtl5*f[j]*r[j])) + h[4][1][m2][j]*((0.17677669529663687*I*m1d*Omega*h[5][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl11*sqrtl5*Omega*h[6][l1][m1][j])/(f[j]*r[j]) - (0.35355339059327373*I*m1d*sqrtl15*sqrtl6*Omega*h[7][l1][m1][j])/(sqrtl5*f[j]*r[j]) + (0.17677669529663687*I*(-4. + (-2.*(-1 + l1d + l1d*l1d) + f[j])*r[j])*h[8][l1][m1][j])/(r_3*f[j]) - (0.17677669529663687*m1d*Omega*h[9][l1][m1][j])/(f[j]*r[j]) + (0.35355339059327373*m1d*sqrtl15*sqrtl6*Omega*h[10][l1][m1][j])/(sqrtl5*f[j]*r[j])));
    }
  } else {
    for(vector<complex<double>>::size_type j=0; j!=ricci.size(); ++j) {
      double r_2 = r[j]*r[j];
      double r_3 = r_2*r[j];
      double f_2 = f[j]*f[j];
      double f_3 = f_2*f[j];

      ricci[j] = (0.35355339059327373*sqrtl12*c1*(2.*f_2*r_2*sqrtl4*dh[6][l1][m1][j]*dh[6][l2][m2][j] - 4.*sqrtl4*f[j]*r[j]*dh[6][l1][m1][j]*h[1][l2][m2][j] - 4.*sqrtl4*h[2][l1][m1][j]*h[2][l2][m2][j] - 4.*sqrtl4*f[j]*h[1][l2][m2][j]*h[3][l1][m1][j] + 4.*f_2*sqrtl4*r[j]*dh[6][l1][m1][j]*h[3][l2][m2][j] + 4.*f_2*sqrtl4*h[3][l1][m1][j]*h[3][l2][m2][j] + 4.*sqrtl4*h[1][l1][m1][j]*(h[1][l2][m2][j] - f[j]*h[3][l2][m2][j]) + 4.*sqrtl11*h[2][l2][m2][j]*h[4][l1][m1][j] + 4.*sqrtl7*h[2][l2][m2][j]*h[4][l1][m1][j] - sqrtl5*h[4][l1][m1][j]*h[4][l2][m2][j] - sqrtl6*h[4][l1][m1][j]*h[4][l2][m2][j] - sqrtl8*h[4][l1][m1][j]*h[4][l2][m2][j] - l1d*l2d*sqrtl8*h[4][l1][m1][j]*h[4][l2][m2][j] + 2.*sqrtl11*f[j]*r[j]*dh[6][l2][m2][j]*h[5][l1][m1][j] + 2.*sqrtl7*f[j]*r[j]*dh[6][l2][m2][j]*h[5][l1][m1][j] - 4.*sqrtl11*h[1][l2][m2][j]*h[5][l1][m1][j] - 4.*sqrtl7*h[1][l2][m2][j]*h[5][l1][m1][j] + 4.*sqrtl11*f[j]*h[3][l2][m2][j]*h[5][l1][m1][j] + 4.*sqrtl7*f[j]*h[3][l2][m2][j]*h[5][l1][m1][j] + sqrtl5*h[5][l1][m1][j]*h[5][l2][m2][j] + sqrtl6*h[5][l1][m1][j]*h[5][l2][m2][j] + sqrtl8*h[5][l1][m1][j]*h[5][l2][m2][j] + l1d*l2d*sqrtl8*h[5][l1][m1][j]*h[5][l2][m2][j] + 4.*f_2*sqrtl4*r[j]*dh[6][l2][m2][j]*h[6][l1][m1][j] - 8.*sqrtl4*f[j]*h[1][l2][m2][j]*h[6][l1][m1][j] - 4.0*I*m1d*sqrtl4*Omega*r[j]*h[2][l2][m2][j]*h[6][l1][m1][j] + 8.*f_2*sqrtl4*h[3][l2][m2][j]*h[6][l1][m1][j] + 2.0*I*m2d*sqrtl11*Omega*r[j]*h[4][l1][m1][j]*h[6][l2][m2][j] + 2.0*I*m2d*sqrtl7*Omega*r[j]*h[4][l1][m1][j]*h[6][l2][m2][j] + 4.*sqrtl11*f[j]*h[5][l1][m1][j]*h[6][l2][m2][j] + 4.*sqrtl7*f[j]*h[5][l1][m1][j]*h[6][l2][m2][j] + 4.*f_2*sqrtl4*h[6][l1][m1][j]*h[6][l2][m2][j] + 2.*m1d*m2d*r_2*sqrtl4*Omega_2*h[6][l1][m1][j]*h[6][l2][m2][j] - sqrtl5*h[8][l1][m1][j]*h[8][l2][m2][j] - sqrtl6*h[8][l1][m1][j]*h[8][l2][m2][j] - sqrtl8*h[8][l1][m1][j]*h[8][l2][m2][j] - l1d*l2d*sqrtl8*h[8][l1][m1][j]*h[8][l2][m2][j] + sqrtl5*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl6*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl8*h[9][l1][m1][j]*h[9][l2][m2][j] + l1d*l2d*sqrtl8*h[9][l1][m1][j]*h[9][l2][m2][j]))/(r_2*f[j]) - (0.08838834764831843*sqrtl13*sqrtl9*c2*(h[7][l1][m1][j] + I*h[10][l1][m1][j])*(h[7][l2][m2][j] - I*h[10][l2][m2][j]))/r_2 - (0.08838834764831843*sqrtl13*sqrtl9*c3*(h[7][l1][m1][j] - I*h[10][l1][m1][j])*(h[7][l2][m2][j] + I*h[10][l2][m2][j]))/r_2 - (0.08838834764831843*c4*(-2.*f_2*r_2*dh[4][l1][m1][j]*dh[4][l2][m2][j] - 2.0*I*f_2*r_2*dh[4][l2][m2][j]*dh[8][l1][m1][j] + 2.0*I*f_2*r_2*dh[4][l1][m1][j]*dh[8][l2][m2][j] - 2.*f_2*r_2*dh[8][l1][m1][j]*dh[8][l2][m2][j] + 2.*f_2*sqrtl2*h[3][l1][m1][j]*h[3][l2][m2][j] - 2.*f_2*r[j]*dh[4][l2][m2][j]*h[4][l1][m1][j] + 2.0*I*f_2*r[j]*dh[8][l2][m2][j]*h[4][l1][m1][j] + 2.*f_2*r[j]*dh[4][l1][m1][j]*h[4][l2][m2][j] + 2.0*I*f_2*r[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] - 2.*f_2*h[4][l1][m1][j]*h[4][l2][m2][j] - 2.0*I*m1d*r_2*Omega*f[j]*dh[4][l2][m2][j]*h[5][l1][m1][j] - 2.*m1d*r_2*Omega*f[j]*dh[8][l2][m2][j]*h[5][l1][m1][j] + 2.0*I*m1d*Omega*f[j]*r[j]*h[4][l2][m2][j]*h[5][l1][m1][j] - 2.0*I*m2d*r_2*Omega*f[j]*dh[4][l1][m1][j]*h[5][l2][m2][j] + 2.*m2d*r_2*Omega*f[j]*dh[8][l1][m1][j]*h[5][l2][m2][j] + 4.*f_2*sqrtl1*h[3][l1][m1][j]*h[5][l2][m2][j] - 2.0*I*m2d*Omega*f[j]*r[j]*h[4][l1][m1][j]*h[5][l2][m2][j] + 12.*f_2*h[5][l1][m1][j]*h[5][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[5][l1][m1][j]*h[5][l2][m2][j] + 4.*f_2*sqrtl2*h[6][l1][m1][j]*h[6][l2][m2][j] - 8.*f_2*sqrtl3*h[5][l2][m2][j]*h[7][l1][m1][j] + 2.*f_2*sqrtl14*h[6][l2][m2][j]*h[7][l1][m1][j] + 2.*f_2*sqrtl10*h[6][l1][m1][j]*h[7][l2][m2][j] + 3.*f_2*sqrtl15*sqrtl3*h[7][l1][m1][j]*h[7][l2][m2][j] - 2.0*I*f_2*r[j]*dh[4][l2][m2][j]*h[8][l1][m1][j] - 2.*f_2*r[j]*dh[8][l2][m2][j]*h[8][l1][m1][j] - 2.0*I*f_2*h[4][l2][m2][j]*h[8][l1][m1][j] + 2.*m2d*Omega*f[j]*r[j]*h[5][l2][m2][j]*h[8][l1][m1][j] - 2.*h[2][l1][m1][j]*(sqrtl2*h[2][l2][m2][j] - 2.*sqrtl1*f[j]*(h[4][l2][m2][j] - I*h[8][l2][m2][j])) - 2.0*I*f_2*r[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] + 2.*f_2*r[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] + 2.0*I*f_2*h[4][l1][m1][j]*h[8][l2][m2][j] + 2.*m1d*Omega*f[j]*r[j]*h[5][l1][m1][j]*h[8][l2][m2][j] - 2.*f_2*h[8][l1][m1][j]*h[8][l2][m2][j] + 2.*m1d*r_2*Omega*f[j]*dh[4][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*m1d*r_2*Omega*f[j]*dh[8][l2][m2][j]*h[9][l1][m1][j] - 2.*m1d*Omega*f[j]*r[j]*h[4][l2][m2][j]*h[9][l1][m1][j] + 12.0*I*f_2*h[5][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*m1d*m2d*r_2*Omega_2*h[5][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*m1d*Omega*f[j]*r[j]*h[8][l2][m2][j]*h[9][l1][m1][j] + 2.*h[1][l1][m1][j]*(sqrtl2*h[1][l2][m2][j] - 2.*sqrtl1*f[j]*(h[5][l2][m2][j] - I*h[9][l2][m2][j])) - 2.*m2d*r_2*Omega*f[j]*dh[4][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*m2d*r_2*Omega*f[j]*dh[8][l1][m1][j]*h[9][l2][m2][j] - 4.0*I*f_2*sqrtl1*h[3][l1][m1][j]*h[9][l2][m2][j] - 2.*m2d*Omega*f[j]*r[j]*h[4][l1][m1][j]*h[9][l2][m2][j] - 12.0*I*f_2*h[5][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*m1d*m2d*r_2*Omega_2*h[5][l1][m1][j]*h[9][l2][m2][j] + 8.0*I*f_2*sqrtl3*h[7][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*m2d*Omega*f[j]*r[j]*h[8][l1][m1][j]*h[9][l2][m2][j] + 12.*f_2*h[9][l1][m1][j]*h[9][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[9][l1][m1][j]*h[9][l2][m2][j] - 8.0*I*f_2*sqrtl3*h[5][l2][m2][j]*h[10][l1][m1][j] + 2.0*I*f_2*sqrtl14*h[6][l2][m2][j]*h[10][l1][m1][j] + 3.0*I*f_2*sqrtl15*sqrtl3*h[7][l2][m2][j]*h[10][l1][m1][j] - 8.*f_2*sqrtl3*h[9][l2][m2][j]*h[10][l1][m1][j] - 2.0*I*f_2*sqrtl10*h[6][l1][m1][j]*h[10][l2][m2][j] - 3.0*I*f_2*sqrtl15*sqrtl3*h[7][l1][m1][j]*h[10][l2][m2][j] + 3.*f_2*sqrtl15*sqrtl3*h[10][l1][m1][j]*h[10][l2][m2][j]))/(f_2*r_2) - (0.08838834764831843*c5*(-2.*f_2*r_2*dh[4][l1][m1][j]*dh[4][l2][m2][j] + 2.0*I*f_2*r_2*dh[4][l2][m2][j]*dh[8][l1][m1][j] - 2.0*I*f_2*r_2*dh[4][l1][m1][j]*dh[8][l2][m2][j] - 2.*f_2*r_2*dh[8][l1][m1][j]*dh[8][l2][m2][j] + 2.*f_2*sqrtl2*h[3][l1][m1][j]*h[3][l2][m2][j] - 2.*f_2*r[j]*dh[4][l2][m2][j]*h[4][l1][m1][j] - 2.0*I*f_2*r[j]*dh[8][l2][m2][j]*h[4][l1][m1][j] + 2.*f_2*r[j]*dh[4][l1][m1][j]*h[4][l2][m2][j] - 2.0*I*f_2*r[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] - 2.*f_2*h[4][l1][m1][j]*h[4][l2][m2][j] - 2.0*I*m1d*r_2*Omega*f[j]*dh[4][l2][m2][j]*h[5][l1][m1][j] + 2.*m1d*r_2*Omega*f[j]*dh[8][l2][m2][j]*h[5][l1][m1][j] + 2.0*I*m1d*Omega*f[j]*r[j]*h[4][l2][m2][j]*h[5][l1][m1][j] - 2.0*I*m2d*r_2*Omega*f[j]*dh[4][l1][m1][j]*h[5][l2][m2][j] - 2.*m2d*r_2*Omega*f[j]*dh[8][l1][m1][j]*h[5][l2][m2][j] + 4.*f_2*sqrtl1*h[3][l1][m1][j]*h[5][l2][m2][j] - 2.0*I*m2d*Omega*f[j]*r[j]*h[4][l1][m1][j]*h[5][l2][m2][j] + 12.*f_2*h[5][l1][m1][j]*h[5][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[5][l1][m1][j]*h[5][l2][m2][j] + 4.*f_2*sqrtl2*h[6][l1][m1][j]*h[6][l2][m2][j] - 8.*f_2*sqrtl3*h[5][l2][m2][j]*h[7][l1][m1][j] + 2.*f_2*sqrtl14*h[6][l2][m2][j]*h[7][l1][m1][j] + 2.*f_2*sqrtl10*h[6][l1][m1][j]*h[7][l2][m2][j] + 3.*f_2*sqrtl15*sqrtl3*h[7][l1][m1][j]*h[7][l2][m2][j] + 2.0*I*f_2*r[j]*dh[4][l2][m2][j]*h[8][l1][m1][j] - 2.*f_2*r[j]*dh[8][l2][m2][j]*h[8][l1][m1][j] + 2.0*I*f_2*h[4][l2][m2][j]*h[8][l1][m1][j] - 2.*m2d*Omega*f[j]*r[j]*h[5][l2][m2][j]*h[8][l1][m1][j] + h[2][l1][m1][j]*(-2.*sqrtl2*h[2][l2][m2][j] + 4.*sqrtl1*f[j]*(h[4][l2][m2][j] + I*h[8][l2][m2][j])) + 2.0*I*f_2*r[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] + 2.*f_2*r[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] - 2.0*I*f_2*h[4][l1][m1][j]*h[8][l2][m2][j] - 2.*m1d*Omega*f[j]*r[j]*h[5][l1][m1][j]*h[8][l2][m2][j] - 2.*f_2*h[8][l1][m1][j]*h[8][l2][m2][j] - 2.*m1d*r_2*Omega*f[j]*dh[4][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*m1d*r_2*Omega*f[j]*dh[8][l2][m2][j]*h[9][l1][m1][j] + 2.*m1d*Omega*f[j]*r[j]*h[4][l2][m2][j]*h[9][l1][m1][j] - 12.0*I*f_2*h[5][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*m1d*m2d*r_2*Omega_2*h[5][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*m1d*Omega*f[j]*r[j]*h[8][l2][m2][j]*h[9][l1][m1][j] + 2.*h[1][l1][m1][j]*(sqrtl2*h[1][l2][m2][j] - 2.*sqrtl1*f[j]*(h[5][l2][m2][j] + I*h[9][l2][m2][j])) + 2.*m2d*r_2*Omega*f[j]*dh[4][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*m2d*r_2*Omega*f[j]*dh[8][l1][m1][j]*h[9][l2][m2][j] + 4.0*I*f_2*sqrtl1*h[3][l1][m1][j]*h[9][l2][m2][j] + 2.*m2d*Omega*f[j]*r[j]*h[4][l1][m1][j]*h[9][l2][m2][j] + 12.0*I*f_2*h[5][l1][m1][j]*h[9][l2][m2][j] + 2.0*I*m1d*m2d*r_2*Omega_2*h[5][l1][m1][j]*h[9][l2][m2][j] - 8.0*I*f_2*sqrtl3*h[7][l1][m1][j]*h[9][l2][m2][j] - 2.0*I*m2d*Omega*f[j]*r[j]*h[8][l1][m1][j]*h[9][l2][m2][j] + 12.*f_2*h[9][l1][m1][j]*h[9][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[9][l1][m1][j]*h[9][l2][m2][j] + 8.0*I*f_2*sqrtl3*h[5][l2][m2][j]*h[10][l1][m1][j] - 2.0*I*f_2*sqrtl14*h[6][l2][m2][j]*h[10][l1][m1][j] - 3.0*I*f_2*sqrtl15*sqrtl3*h[7][l2][m2][j]*h[10][l1][m1][j] - 8.*f_2*sqrtl3*h[9][l2][m2][j]*h[10][l1][m1][j] + 2.0*I*f_2*sqrtl10*h[6][l1][m1][j]*h[10][l2][m2][j] + 3.0*I*f_2*sqrtl15*sqrtl3*h[7][l1][m1][j]*h[10][l2][m2][j] + 3.*f_2*sqrtl15*sqrtl3*h[10][l1][m1][j]*h[10][l2][m2][j]))/(f_2*r_2) + (0.17677669529663687*c7*(2.*f_2*r_2*dh[7][l1][m1][j]*dh[7][l2][m2][j] + 2.0*I*f_2*r_2*dh[7][l2][m2][j]*dh[10][l1][m1][j] - 2.0*I*f_2*r_2*dh[7][l1][m1][j]*dh[10][l2][m2][j] + 2.*f_2*r_2*dh[10][l1][m1][j]*dh[10][l2][m2][j] + 4.*f_2*r[j]*dh[7][l2][m2][j]*h[7][l1][m1][j] - 4.0*I*f_2*r[j]*dh[10][l2][m2][j]*h[7][l1][m1][j] + 4.*f_2*h[7][l1][m1][j]*h[7][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[7][l1][m1][j]*h[7][l2][m2][j] - I*sqrtl15*sqrtl3*h[4][l2][m2][j]*h[8][l1][m1][j] + 2.*m2d*sqrtl3*Omega*r[j]*h[7][l2][m2][j]*h[8][l1][m1][j] - sqrtl15*sqrtl3*h[8][l1][m1][j]*h[8][l2][m2][j] - 2.0*I*sqrtl3*f[j]*r[j]*dh[7][l2][m2][j]*h[9][l1][m1][j] - 2.*sqrtl3*f[j]*r[j]*dh[10][l2][m2][j]*h[9][l1][m1][j] + I*sqrtl15*sqrtl3*h[5][l2][m2][j]*h[9][l1][m1][j] - 4.0*I*sqrtl3*f[j]*h[7][l2][m2][j]*h[9][l1][m1][j] + sqrtl15*sqrtl3*h[9][l1][m1][j]*h[9][l2][m2][j] + 4.0*I*f_2*r[j]*dh[7][l2][m2][j]*h[10][l1][m1][j] + 4.*f_2*r[j]*dh[10][l2][m2][j]*h[10][l1][m1][j] + 4.0*I*f_2*h[7][l2][m2][j]*h[10][l1][m1][j] + 2.0*I*m1d*m2d*r_2*Omega_2*h[7][l2][m2][j]*h[10][l1][m1][j] + sqrtl3*h[5][l1][m1][j]*(sqrtl15*h[5][l2][m2][j] - I*sqrtl15*h[9][l2][m2][j] + f[j]*(-2.*r[j]*dh[7][l2][m2][j] + 2.0*I*r[j]*dh[10][l2][m2][j] - 4.*h[7][l2][m2][j] + 4.0*I*h[10][l2][m2][j])) - 4.0*I*f_2*h[7][l1][m1][j]*h[10][l2][m2][j] - 2.0*I*m1d*m2d*r_2*Omega_2*h[7][l1][m1][j]*h[10][l2][m2][j] - 2.0*I*m2d*sqrtl3*Omega*r[j]*h[8][l1][m1][j]*h[10][l2][m2][j] - 4.*sqrtl3*f[j]*h[9][l1][m1][j]*h[10][l2][m2][j] + 4.*f_2*h[10][l1][m1][j]*h[10][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[10][l1][m1][j]*h[10][l2][m2][j] + sqrtl3*h[4][l1][m1][j]*(-(sqrtl15*h[4][l2][m2][j]) + I*sqrtl15*h[8][l2][m2][j] + 2.*r[j]*(-1.0*I*m2d*Omega*h[7][l2][m2][j] - m2d*Omega*h[10][l2][m2][j]))))/(r_2*f[j]) + (0.17677669529663687*c6*(2.*f_2*r_2*dh[7][l1][m1][j]*dh[7][l2][m2][j] - 2.0*I*f_2*r_2*dh[7][l2][m2][j]*dh[10][l1][m1][j] + 2.0*I*f_2*r_2*dh[7][l1][m1][j]*dh[10][l2][m2][j] + 2.*f_2*r_2*dh[10][l1][m1][j]*dh[10][l2][m2][j] + 4.*f_2*r[j]*dh[7][l2][m2][j]*h[7][l1][m1][j] + 4.0*I*f_2*r[j]*dh[10][l2][m2][j]*h[7][l1][m1][j] + 4.*f_2*h[7][l1][m1][j]*h[7][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[7][l1][m1][j]*h[7][l2][m2][j] + I*sqrtl15*sqrtl3*h[4][l2][m2][j]*h[8][l1][m1][j] - 2.*m2d*sqrtl3*Omega*r[j]*h[7][l2][m2][j]*h[8][l1][m1][j] - sqrtl15*sqrtl3*h[8][l1][m1][j]*h[8][l2][m2][j] + 2.0*I*sqrtl3*f[j]*r[j]*dh[7][l2][m2][j]*h[9][l1][m1][j] - 2.*sqrtl3*f[j]*r[j]*dh[10][l2][m2][j]*h[9][l1][m1][j] - I*sqrtl15*sqrtl3*h[5][l2][m2][j]*h[9][l1][m1][j] + 4.0*I*sqrtl3*f[j]*h[7][l2][m2][j]*h[9][l1][m1][j] + sqrtl15*sqrtl3*h[9][l1][m1][j]*h[9][l2][m2][j] - 4.0*I*f_2*r[j]*dh[7][l2][m2][j]*h[10][l1][m1][j] + 4.*f_2*r[j]*dh[10][l2][m2][j]*h[10][l1][m1][j] - 4.0*I*f_2*h[7][l2][m2][j]*h[10][l1][m1][j] - 2.0*I*m1d*m2d*r_2*Omega_2*h[7][l2][m2][j]*h[10][l1][m1][j] + sqrtl3*h[5][l1][m1][j]*(sqrtl15*h[5][l2][m2][j] + I*sqrtl15*h[9][l2][m2][j] - 2.*f[j]*(r[j]*dh[7][l2][m2][j] + I*r[j]*dh[10][l2][m2][j] + 2.*h[7][l2][m2][j] + 2.0*I*h[10][l2][m2][j])) + 4.0*I*f_2*h[7][l1][m1][j]*h[10][l2][m2][j] + 2.0*I*m1d*m2d*r_2*Omega_2*h[7][l1][m1][j]*h[10][l2][m2][j] - 2.0*I*m2d*sqrtl3*Omega*r[j]*h[8][l1][m1][j]*h[10][l2][m2][j] - 4.*sqrtl3*f[j]*h[9][l1][m1][j]*h[10][l2][m2][j] + 4.*f_2*h[10][l1][m1][j]*h[10][l2][m2][j] + 2.*m1d*m2d*r_2*Omega_2*h[10][l1][m1][j]*h[10][l2][m2][j] + sqrtl3*h[4][l1][m1][j]*(-(sqrtl15*h[4][l2][m2][j]) - I*sqrtl15*h[8][l2][m2][j] + 2.*r[j]*(-1.0*I*m2d*Omega*h[7][l2][m2][j] + m2d*Omega*h[10][l2][m2][j]))))/(r_2*f[j]);
      ricci[j]+= (0.7071067811865475*sqrtl18*c1*(2.0*I*m1d*r_2*sqrtl16*Omega*h[1][l2][m2][j]*h[2][l1][m1][j] - 2.0*I*m1d*r_2*sqrtl16*Omega*h[1][l1][m1][j]*h[2][l2][m2][j] + l1d*l1d*sqrtl16*r[j]*h[2][l1][m1][j]*h[2][l2][m2][j] + l1d*sqrtl16*r[j]*h[2][l1][m1][j]*h[2][l2][m2][j] - sqrtl16*h[1][l1][m1][j]*((4. - 2.*r_2*fp[j] + l1d*(1 + l1d)*r[j])*h[1][l2][m2][j] + 2.*f[j]*(-2. + r_2*fp[j])*h[3][l2][m2][j]) - I*m1d*r_2*sqrtl17*Omega*h[1][l2][m2][j]*h[4][l1][m1][j] - I*l1d*m1d*r_2*sqrtl17*Omega*h[1][l2][m2][j]*h[4][l1][m1][j] + 2.*sqrtl17*h[2][l2][m2][j]*h[4][l1][m1][j] + 2.*l1d*sqrtl17*h[2][l2][m2][j]*h[4][l1][m1][j] - r_2*sqrtl17*fp[j]*h[1][l2][m2][j]*h[5][l1][m1][j] - l1d*r_2*sqrtl17*fp[j]*h[1][l2][m2][j]*h[5][l1][m1][j] + I*m1d*r_2*sqrtl17*Omega*h[2][l2][m2][j]*h[5][l1][m1][j] + I*l1d*m1d*r_2*sqrtl17*Omega*h[2][l2][m2][j]*h[5][l1][m1][j] - m1d*m1d*r_3*sqrtl16*Omega_2*h[1][l2][m2][j]*h[6][l1][m1][j] - 2.0*I*m1d*sqrtl16*Omega*r[j]*h[2][l2][m2][j]*h[6][l1][m1][j] + f[j]*(h[3][l2][m2][j]*(-((1 + l1d)*sqrtl17*(2. - r_2*fp[j])*h[5][l1][m1][j]) + r_2*(2.0*I*m1d*sqrtl16*Omega*h[2][l1][m1][j] - I*(1 + l1d)*m1d*sqrtl17*Omega*h[4][l1][m1][j] - m1d*m1d*sqrtl16*Omega_2*r[j]*h[6][l1][m1][j])) - r[j]*(-((1 + l1d)*sqrtl17*h[1][l2][m2][j]*(r[j]*dh[5][l1][m1][j] + h[5][l1][m1][j])) + h[2][l2][m2][j]*((1 + l1d)*sqrtl17*h[4][l1][m1][j] + r[j]*(sqrtl17*dh[4][l1][m1][j] + l1d*sqrtl17*dh[4][l1][m1][j] - 2.0*I*m1d*sqrtl16*Omega*r[j]*dh[6][l1][m1][j] - 2.0*I*m1d*sqrtl16*Omega*h[3][l1][m1][j] - 2.0*I*m1d*sqrtl16*Omega*h[6][l1][m1][j])))) + f_3*sqrtl16*r[j]*(h[3][l2][m2][j]*(-(r[j]*(r[j]*ddh[6][l1][m1][j] + 2.*dh[6][l1][m1][j])) + 2.*h[6][l1][m1][j]) + 2.*(r[j]*dh[6][l1][m1][j] + h[6][l1][m1][j])*h[6][l2][m2][j]) - f_2*(sqrtl16*(8. - 2.*r_2*fp[j] + l1d*(1 + l1d)*r[j])*h[3][l1][m1][j]*h[3][l2][m2][j] + h[3][l2][m2][j]*(r[j]*(r[j]*(-2.*sqrtl16*dh[1][l1][m1][j] + (1 + l1d)*sqrtl17*dh[5][l1][m1][j]) + 2.*sqrtl16*dh[6][l1][m1][j] + (1 + l1d)*sqrtl17*h[5][l1][m1][j]) + 4.*sqrtl16*h[6][l1][m1][j]) + r[j]*(sqrtl16*h[1][l2][m2][j]*(-(r[j]*(r[j]*ddh[6][l1][m1][j] + 2.*dh[3][l1][m1][j] + 2.*dh[6][l1][m1][j])) + 2.*h[6][l1][m1][j]) + (1 + l1d)*sqrtl17*(-2.*h[5][l1][m1][j] + sqrtl1*h[6][l1][m1][j])*h[6][l2][m2][j]))))/(f_2*r_3) - (0.35355339059327373*sqrtl18*c4*(-(r_2*sqrtl16*f[j]*dh[4][l1][m1][j]*h[4][l2][m2][j]) - I*r_2*sqrtl16*f[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] + sqrtl17*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] + l1d*sqrtl17*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*sqrtl16*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] + r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[5][l2][m2][j] + l1d*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[5][l2][m2][j] + r_2*sqrtl19*f[j]*dh[7][l1][m1][j]*h[5][l2][m2][j] + I*r_2*sqrtl19*f[j]*dh[10][l1][m1][j]*h[5][l2][m2][j] - sqrtl17*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] - l1d*sqrtl17*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[5][l2][m2][j] + l1d*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*sqrtl17*Omega*h[4][l2][m2][j]*h[6][l1][m1][j] + I*l1d*m1d*r_2*sqrtl17*Omega*h[4][l2][m2][j]*h[6][l1][m1][j] + I*m1d*r_2*sqrtl19*Omega*h[4][l2][m2][j]*h[7][l1][m1][j] + 2.0*I*sqrtl16*h[4][l2][m2][j]*h[8][l1][m1][j] - I*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] + I*l1d*l1d*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] + I*l1d*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] + sqrtl16*(2. - r[j])*h[4][l1][m1][j]*(h[4][l2][m2][j] - I*h[8][l2][m2][j]) + I*r_2*sqrtl16*f[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] - r_2*sqrtl16*f[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] - I*sqrtl17*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] - I*l1d*sqrtl17*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*sqrtl16*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*sqrtl17*Omega*h[6][l1][m1][j]*h[8][l2][m2][j] + l1d*m1d*r_2*sqrtl17*Omega*h[6][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*sqrtl19*Omega*h[7][l1][m1][j]*h[8][l2][m2][j] + 2.*sqrtl16*h[8][l1][m1][j]*h[8][l2][m2][j] - sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + l1d*l1d*sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + l1d*sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*sqrtl16*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] - 2.0*I*sqrtl16*h[5][l2][m2][j]*h[9][l1][m1][j] + I*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*l1d*l1d*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*l1d*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] + I*sqrtl16*f[j]*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*m1d*r_2*sqrtl16*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] - sqrtl16*(2. - r[j] - f[j]*r[j])*h[5][l1][m1][j]*(h[5][l2][m2][j] - I*h[9][l2][m2][j]) - I*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[9][l2][m2][j] - I*l1d*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[9][l2][m2][j] - I*r_2*sqrtl19*f[j]*dh[7][l1][m1][j]*h[9][l2][m2][j] + r_2*sqrtl19*f[j]*dh[10][l1][m1][j]*h[9][l2][m2][j] + I*sqrtl17*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] + I*l1d*sqrtl17*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] - I*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[9][l2][m2][j] - I*l1d*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[9][l2][m2][j] - 2.*sqrtl16*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] - l1d*l1d*sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] - l1d*sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl16*f[j]*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] - m1d*r_2*sqrtl19*Omega*h[4][l2][m2][j]*h[10][l1][m1][j] + I*m1d*r_2*sqrtl19*Omega*h[8][l2][m2][j]*h[10][l1][m1][j]))/(r_3*f[j]) - (0.35355339059327373*sqrtl18*c5*(-(r_2*sqrtl16*f[j]*dh[4][l1][m1][j]*h[4][l2][m2][j]) + I*r_2*sqrtl16*f[j]*dh[8][l1][m1][j]*h[4][l2][m2][j] + sqrtl17*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] + l1d*sqrtl17*r[j]*h[2][l1][m1][j]*h[4][l2][m2][j] - I*m1d*r_2*sqrtl16*Omega*h[4][l2][m2][j]*h[5][l1][m1][j] + r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[5][l2][m2][j] + l1d*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[5][l2][m2][j] + r_2*sqrtl19*f[j]*dh[7][l1][m1][j]*h[5][l2][m2][j] - I*r_2*sqrtl19*f[j]*dh[10][l1][m1][j]*h[5][l2][m2][j] - sqrtl17*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] - l1d*sqrtl17*r[j]*h[1][l1][m1][j]*h[5][l2][m2][j] + sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[5][l2][m2][j] + l1d*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[5][l2][m2][j] + I*m1d*r_2*sqrtl17*Omega*h[4][l2][m2][j]*h[6][l1][m1][j] + I*l1d*m1d*r_2*sqrtl17*Omega*h[4][l2][m2][j]*h[6][l1][m1][j] + I*m1d*r_2*sqrtl19*Omega*h[4][l2][m2][j]*h[7][l1][m1][j] - 2.0*I*sqrtl16*h[4][l2][m2][j]*h[8][l1][m1][j] + I*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] - I*l1d*l1d*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] - I*l1d*sqrtl16*r[j]*h[4][l2][m2][j]*h[8][l1][m1][j] + sqrtl16*(2. - r[j])*h[4][l1][m1][j]*(h[4][l2][m2][j] + I*h[8][l2][m2][j]) - I*r_2*sqrtl16*f[j]*dh[4][l1][m1][j]*h[8][l2][m2][j] - r_2*sqrtl16*f[j]*dh[8][l1][m1][j]*h[8][l2][m2][j] + I*sqrtl17*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] + I*l1d*sqrtl17*r[j]*h[2][l1][m1][j]*h[8][l2][m2][j] + m1d*r_2*sqrtl16*Omega*h[5][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*sqrtl17*Omega*h[6][l1][m1][j]*h[8][l2][m2][j] - l1d*m1d*r_2*sqrtl17*Omega*h[6][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*sqrtl19*Omega*h[7][l1][m1][j]*h[8][l2][m2][j] + 2.*sqrtl16*h[8][l1][m1][j]*h[8][l2][m2][j] - sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + l1d*l1d*sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] + l1d*sqrtl16*r[j]*h[8][l1][m1][j]*h[8][l2][m2][j] - m1d*r_2*sqrtl16*Omega*h[4][l2][m2][j]*h[9][l1][m1][j] + 2.0*I*sqrtl16*h[5][l2][m2][j]*h[9][l1][m1][j] - I*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] + I*l1d*l1d*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] + I*l1d*sqrtl16*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*sqrtl16*f[j]*r[j]*h[5][l2][m2][j]*h[9][l1][m1][j] - I*m1d*r_2*sqrtl16*Omega*h[8][l2][m2][j]*h[9][l1][m1][j] - sqrtl16*(2. - r[j] - f[j]*r[j])*h[5][l1][m1][j]*(h[5][l2][m2][j] + I*h[9][l2][m2][j]) + I*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[9][l2][m2][j] + I*l1d*r_2*sqrtl17*f[j]*dh[6][l1][m1][j]*h[9][l2][m2][j] + I*r_2*sqrtl19*f[j]*dh[7][l1][m1][j]*h[9][l2][m2][j] + r_2*sqrtl19*f[j]*dh[10][l1][m1][j]*h[9][l2][m2][j] - I*sqrtl17*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] - I*l1d*sqrtl17*r[j]*h[1][l1][m1][j]*h[9][l2][m2][j] + I*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[9][l2][m2][j] + I*l1d*sqrtl17*f[j]*r[j]*h[3][l1][m1][j]*h[9][l2][m2][j] - 2.*sqrtl16*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] - l1d*l1d*sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] - l1d*sqrtl16*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] + sqrtl16*f[j]*r[j]*h[9][l1][m1][j]*h[9][l2][m2][j] + m1d*r_2*sqrtl19*Omega*h[4][l2][m2][j]*h[10][l1][m1][j] + I*m1d*r_2*sqrtl19*Omega*h[8][l2][m2][j]*h[10][l1][m1][j]))/(r_3*f[j]) - (0.7071067811865475*c7*(-1 + f[j])*(h[7][l1][m1][j] + I*h[10][l1][m1][j])*(h[7][l2][m2][j] - I*h[10][l2][m2][j]))/r_2 - (0.7071067811865475*c6*(-1 + f[j])*(h[7][l1][m1][j] - I*h[10][l1][m1][j])*(h[7][l2][m2][j] + I*h[10][l2][m2][j]))/r_2;
    }
  }

  return ricci;
}
